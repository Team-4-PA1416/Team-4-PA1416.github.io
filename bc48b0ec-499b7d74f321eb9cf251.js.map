{"version":3,"file":"bc48b0ec-499b7d74f321eb9cf251.js","mappings":"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","sources":["webpack://safe-parasport/./node_modules/@tiptap/core/dist/tiptap-core.esm.js"],"sourcesContent":["import _assertThisInitialized from \"/home/simon/safe-parasport/web/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";\nimport _inherits from \"/home/simon/safe-parasport/web/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _possibleConstructorReturn from \"/home/simon/safe-parasport/web/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js\";\nimport _getPrototypeOf from \"/home/simon/safe-parasport/web/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";\nimport _toConsumableArray from \"/home/simon/safe-parasport/web/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _slicedToArray from \"/home/simon/safe-parasport/web/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _classCallCheck from \"/home/simon/safe-parasport/web/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/home/simon/safe-parasport/web/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _defineProperty from \"/home/simon/safe-parasport/web/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport \"core-js/modules/es.object.from-entries.js\";\nimport \"core-js/modules/esnext.string.match-all.js\";\nimport \"core-js/modules/es.array.flat.js\";\nimport \"core-js/modules/es.array.unscopables.flat.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nimport { Plugin, PluginKey, TextSelection, Selection, NodeSelection, EditorState } from 'prosemirror-state';\nimport { liftTarget, ReplaceStep, ReplaceAroundStep, canSplit, canJoin, findWrapping, Transform } from 'prosemirror-transform';\nimport { createParagraphNear as createParagraphNear$2, deleteSelection as deleteSelection$2, exitCode as exitCode$2, joinBackward as joinBackward$2, joinForward as joinForward$2, lift as lift$2, liftEmptyBlock as liftEmptyBlock$2, newlineInCode as newlineInCode$2, selectNodeBackward as selectNodeBackward$2, selectNodeForward as selectNodeForward$2, selectParentNode as selectParentNode$2, selectTextblockEnd as selectTextblockEnd$2, selectTextblockStart as selectTextblockStart$2, setBlockType, wrapIn as wrapIn$2 } from 'prosemirror-commands';\nimport { Fragment, DOMParser, Slice, DOMSerializer, Schema, Node as Node$1 } from 'prosemirror-model';\nimport { liftListItem as liftListItem$2, sinkListItem as sinkListItem$2, wrapInList as wrapInList$2 } from 'prosemirror-schema-list';\nimport { EditorView } from 'prosemirror-view';\nimport { keymap } from 'prosemirror-keymap'; // see: https://github.com/mesqueeb/is-what/blob/88d6e4ca92fb2baab6003c54e02eedf4e729e5ab/src/index.ts\n\nfunction getType(value) {\n  return Object.prototype.toString.call(value).slice(8, -1);\n}\n\nfunction isPlainObject(value) {\n  if (getType(value) !== 'Object') {\n    return false;\n  }\n\n  return value.constructor === Object && Object.getPrototypeOf(value) === Object.prototype;\n}\n\nfunction mergeDeep(target, source) {\n  var output = _objectSpread({}, target);\n\n  if (isPlainObject(target) && isPlainObject(source)) {\n    Object.keys(source).forEach(function (key) {\n      if (isPlainObject(source[key])) {\n        if (!(key in target)) {\n          Object.assign(output, _defineProperty({}, key, source[key]));\n        } else {\n          output[key] = mergeDeep(target[key], source[key]);\n        }\n      } else {\n        Object.assign(output, _defineProperty({}, key, source[key]));\n      }\n    });\n  }\n\n  return output;\n}\n\nfunction isFunction(value) {\n  return typeof value === 'function';\n}\n/**\r\n * Optionally calls `value` as a function.\r\n * Otherwise it is returned directly.\r\n * @param value Function or any value.\r\n * @param context Optional context to bind to function.\r\n * @param props Optional props to pass to function.\r\n */\n\n\nfunction callOrReturn(value) {\n  var context = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : undefined;\n\n  if (isFunction(value)) {\n    for (var _len = arguments.length, props = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n      props[_key - 2] = arguments[_key];\n    }\n\n    if (context) {\n      return value.bind(context).apply(void 0, props);\n    }\n\n    return value.apply(void 0, props);\n  }\n\n  return value;\n}\n\nfunction getExtensionField(extension, field, context) {\n  if (extension.config[field] === undefined && extension.parent) {\n    return getExtensionField(extension.parent, field, context);\n  }\n\n  if (typeof extension.config[field] === 'function') {\n    var value = extension.config[field].bind(_objectSpread(_objectSpread({}, context), {}, {\n      parent: extension.parent ? getExtensionField(extension.parent, field, context) : null\n    }));\n    return value;\n  }\n\n  return extension.config[field];\n}\n\nvar Extension = /*#__PURE__*/function () {\n  function Extension() {\n    var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, Extension);\n\n    this.type = 'extension';\n    this.name = 'extension';\n    this.parent = null;\n    this.child = null;\n    this.config = {\n      name: this.name,\n      defaultOptions: {}\n    };\n    this.config = _objectSpread(_objectSpread({}, this.config), config);\n    this.name = this.config.name;\n\n    if (config.defaultOptions) {\n      console.warn(\"[tiptap warn]: BREAKING CHANGE: \\\"defaultOptions\\\" is deprecated. Please use \\\"addOptions\\\" instead. Found in extension: \\\"\".concat(this.name, \"\\\".\"));\n    } // TODO: remove `addOptions` fallback\n\n\n    this.options = this.config.defaultOptions;\n\n    if (this.config.addOptions) {\n      this.options = callOrReturn(getExtensionField(this, 'addOptions', {\n        name: this.name\n      }));\n    }\n\n    this.storage = callOrReturn(getExtensionField(this, 'addStorage', {\n      name: this.name,\n      options: this.options\n    })) || {};\n  }\n\n  _createClass(Extension, [{\n    key: \"configure\",\n    value: function configure() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      // return a new instance so we can use the same extension\n      // with different calls of `configure`\n      var extension = this.extend();\n      extension.options = mergeDeep(this.options, options);\n      extension.storage = callOrReturn(getExtensionField(extension, 'addStorage', {\n        name: extension.name,\n        options: extension.options\n      }));\n      return extension;\n    }\n  }, {\n    key: \"extend\",\n    value: function extend() {\n      var extendedConfig = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var extension = new Extension(extendedConfig);\n      extension.parent = this;\n      this.child = extension;\n      extension.name = extendedConfig.name ? extendedConfig.name : extension.parent.name;\n\n      if (extendedConfig.defaultOptions) {\n        console.warn(\"[tiptap warn]: BREAKING CHANGE: \\\"defaultOptions\\\" is deprecated. Please use \\\"addOptions\\\" instead. Found in extension: \\\"\".concat(extension.name, \"\\\".\"));\n      }\n\n      extension.options = callOrReturn(getExtensionField(extension, 'addOptions', {\n        name: extension.name\n      }));\n      extension.storage = callOrReturn(getExtensionField(extension, 'addStorage', {\n        name: extension.name,\n        options: extension.options\n      }));\n      return extension;\n    }\n  }], [{\n    key: \"create\",\n    value: function create() {\n      var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      return new Extension(config);\n    }\n  }]);\n\n  return Extension;\n}();\n\nfunction getTextBetween(startNode, range, options) {\n  var from = range.from,\n      to = range.to;\n\n  var _ref = options || {},\n      _ref$blockSeparator = _ref.blockSeparator,\n      blockSeparator = _ref$blockSeparator === void 0 ? '\\n\\n' : _ref$blockSeparator,\n      _ref$textSerializers = _ref.textSerializers,\n      textSerializers = _ref$textSerializers === void 0 ? {} : _ref$textSerializers;\n\n  var text = '';\n  var separated = true;\n  startNode.nodesBetween(from, to, function (node, pos, parent, index) {\n    var _a;\n\n    var textSerializer = textSerializers === null || textSerializers === void 0 ? void 0 : textSerializers[node.type.name];\n\n    if (textSerializer) {\n      if (node.isBlock && !separated) {\n        text += blockSeparator;\n        separated = true;\n      }\n\n      text += textSerializer({\n        node: node,\n        pos: pos,\n        parent: parent,\n        index: index\n      });\n    } else if (node.isText) {\n      text += (_a = node === null || node === void 0 ? void 0 : node.text) === null || _a === void 0 ? void 0 : _a.slice(Math.max(from, pos) - pos, to - pos);\n      separated = false;\n    } else if (node.isBlock && !separated) {\n      text += blockSeparator;\n      separated = true;\n    }\n  });\n  return text;\n}\n\nfunction getTextSeralizersFromSchema(schema) {\n  return Object.fromEntries(Object.entries(schema.nodes).filter(function (_ref2) {\n    var _ref3 = _slicedToArray(_ref2, 2),\n        node = _ref3[1];\n\n    return node.spec.toText;\n  }).map(function (_ref4) {\n    var _ref5 = _slicedToArray(_ref4, 2),\n        name = _ref5[0],\n        node = _ref5[1];\n\n    return [name, node.spec.toText];\n  }));\n}\n\nvar ClipboardTextSerializer = Extension.create({\n  name: 'clipboardTextSerializer',\n  addProseMirrorPlugins: function addProseMirrorPlugins() {\n    var _this = this;\n\n    return [new Plugin({\n      key: new PluginKey('clipboardTextSerializer'),\n      props: {\n        clipboardTextSerializer: function clipboardTextSerializer() {\n          var editor = _this.editor;\n          var state = editor.state,\n              schema = editor.schema;\n          var doc = state.doc,\n              selection = state.selection;\n          var ranges = selection.ranges;\n          var from = Math.min.apply(Math, _toConsumableArray(ranges.map(function (range) {\n            return range.$from.pos;\n          })));\n          var to = Math.max.apply(Math, _toConsumableArray(ranges.map(function (range) {\n            return range.$to.pos;\n          })));\n          var textSerializers = getTextSeralizersFromSchema(schema);\n          var range = {\n            from: from,\n            to: to\n          };\n          return getTextBetween(doc, range, {\n            textSerializers: textSerializers\n          });\n        }\n      }\n    })];\n  }\n});\n\nvar blur = function blur() {\n  return function (_ref6) {\n    var editor = _ref6.editor,\n        view = _ref6.view;\n    requestAnimationFrame(function () {\n      var _a;\n\n      if (!editor.isDestroyed) {\n        view.dom.blur(); // Browsers should remove the caret on blur but safari does not.\n        // See: https://github.com/ueberdosis/tiptap/issues/2405\n\n        (_a = window === null || window === void 0 ? void 0 : window.getSelection()) === null || _a === void 0 ? void 0 : _a.removeAllRanges();\n      }\n    });\n    return true;\n  };\n};\n\nvar blur$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  blur: blur\n});\n\nvar clearContent = function clearContent() {\n  var emitUpdate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n  return function (_ref7) {\n    var commands = _ref7.commands;\n    return commands.setContent('', emitUpdate);\n  };\n};\n\nvar clearContent$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  clearContent: clearContent\n});\n\nvar clearNodes = function clearNodes() {\n  return function (_ref8) {\n    var state = _ref8.state,\n        tr = _ref8.tr,\n        dispatch = _ref8.dispatch;\n    var selection = tr.selection;\n    var ranges = selection.ranges;\n\n    if (!dispatch) {\n      return true;\n    }\n\n    ranges.forEach(function (_ref9) {\n      var $from = _ref9.$from,\n          $to = _ref9.$to;\n      state.doc.nodesBetween($from.pos, $to.pos, function (node, pos) {\n        if (node.type.isText) {\n          return;\n        }\n\n        var doc = tr.doc,\n            mapping = tr.mapping;\n        var $mappedFrom = doc.resolve(mapping.map(pos));\n        var $mappedTo = doc.resolve(mapping.map(pos + node.nodeSize));\n        var nodeRange = $mappedFrom.blockRange($mappedTo);\n\n        if (!nodeRange) {\n          return;\n        }\n\n        var targetLiftDepth = liftTarget(nodeRange);\n\n        if (node.type.isTextblock) {\n          var _$mappedFrom$parent$c = $mappedFrom.parent.contentMatchAt($mappedFrom.index()),\n              defaultType = _$mappedFrom$parent$c.defaultType;\n\n          tr.setNodeMarkup(nodeRange.start, defaultType);\n        }\n\n        if (targetLiftDepth || targetLiftDepth === 0) {\n          tr.lift(nodeRange, targetLiftDepth);\n        }\n      });\n    });\n    return true;\n  };\n};\n\nvar clearNodes$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  clearNodes: clearNodes\n});\n\nvar command = function command(fn) {\n  return function (props) {\n    return fn(props);\n  };\n};\n\nvar command$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  command: command\n});\n\nvar createParagraphNear = function createParagraphNear() {\n  return function (_ref10) {\n    var state = _ref10.state,\n        dispatch = _ref10.dispatch;\n    return createParagraphNear$2(state, dispatch);\n  };\n};\n\nvar createParagraphNear$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  createParagraphNear: createParagraphNear\n});\n\nfunction getNodeType(nameOrType, schema) {\n  if (typeof nameOrType === 'string') {\n    if (!schema.nodes[nameOrType]) {\n      throw Error(\"There is no node type named '\".concat(nameOrType, \"'. Maybe you forgot to add the extension?\"));\n    }\n\n    return schema.nodes[nameOrType];\n  }\n\n  return nameOrType;\n}\n\nvar deleteNode = function deleteNode(typeOrName) {\n  return function (_ref11) {\n    var tr = _ref11.tr,\n        state = _ref11.state,\n        dispatch = _ref11.dispatch;\n    var type = getNodeType(typeOrName, state.schema);\n    var $pos = tr.selection.$anchor;\n\n    for (var depth = $pos.depth; depth > 0; depth -= 1) {\n      var node = $pos.node(depth);\n\n      if (node.type === type) {\n        if (dispatch) {\n          var from = $pos.before(depth);\n          var to = $pos.after(depth);\n          tr.delete(from, to).scrollIntoView();\n        }\n\n        return true;\n      }\n    }\n\n    return false;\n  };\n};\n\nvar deleteNode$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  deleteNode: deleteNode\n});\n\nvar deleteRange = function deleteRange(range) {\n  return function (_ref12) {\n    var tr = _ref12.tr,\n        dispatch = _ref12.dispatch;\n    var from = range.from,\n        to = range.to;\n\n    if (dispatch) {\n      tr.delete(from, to);\n    }\n\n    return true;\n  };\n};\n\nvar deleteRange$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  deleteRange: deleteRange\n});\n\nvar deleteSelection = function deleteSelection() {\n  return function (_ref13) {\n    var state = _ref13.state,\n        dispatch = _ref13.dispatch;\n    return deleteSelection$2(state, dispatch);\n  };\n};\n\nvar deleteSelection$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  deleteSelection: deleteSelection\n});\n\nvar enter = function enter() {\n  return function (_ref14) {\n    var commands = _ref14.commands;\n    return commands.keyboardShortcut('Enter');\n  };\n};\n\nvar enter$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  enter: enter\n});\n\nvar exitCode = function exitCode() {\n  return function (_ref15) {\n    var state = _ref15.state,\n        dispatch = _ref15.dispatch;\n    return exitCode$2(state, dispatch);\n  };\n};\n\nvar exitCode$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  exitCode: exitCode\n});\n\nfunction getMarkType(nameOrType, schema) {\n  if (typeof nameOrType === 'string') {\n    if (!schema.marks[nameOrType]) {\n      throw Error(\"There is no mark type named '\".concat(nameOrType, \"'. Maybe you forgot to add the extension?\"));\n    }\n\n    return schema.marks[nameOrType];\n  }\n\n  return nameOrType;\n}\n\nfunction isRegExp(value) {\n  return Object.prototype.toString.call(value) === '[object RegExp]';\n}\n/**\r\n * Check if object1 includes object2\r\n * @param object1 Object\r\n * @param object2 Object\r\n */\n\n\nfunction objectIncludes(object1, object2) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {\n    strict: true\n  };\n  var keys = Object.keys(object2);\n\n  if (!keys.length) {\n    return true;\n  }\n\n  return keys.every(function (key) {\n    if (options.strict) {\n      return object2[key] === object1[key];\n    }\n\n    if (isRegExp(object2[key])) {\n      return object2[key].test(object1[key]);\n    }\n\n    return object2[key] === object1[key];\n  });\n}\n\nfunction findMarkInSet(marks, type) {\n  var attributes = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return marks.find(function (item) {\n    return item.type === type && objectIncludes(item.attrs, attributes);\n  });\n}\n\nfunction isMarkInSet(marks, type) {\n  var attributes = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return !!findMarkInSet(marks, type, attributes);\n}\n\nfunction getMarkRange($pos, type) {\n  var attributes = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  if (!$pos || !type) {\n    return;\n  }\n\n  var start = $pos.parent.childAfter($pos.parentOffset);\n\n  if (!start.node) {\n    return;\n  }\n\n  var mark = findMarkInSet(start.node.marks, type, attributes);\n\n  if (!mark) {\n    return;\n  }\n\n  var startIndex = $pos.index();\n  var startPos = $pos.start() + start.offset;\n  var endIndex = startIndex + 1;\n  var endPos = startPos + start.node.nodeSize;\n  findMarkInSet(start.node.marks, type, attributes);\n\n  while (startIndex > 0 && mark.isInSet($pos.parent.child(startIndex - 1).marks)) {\n    startIndex -= 1;\n    startPos -= $pos.parent.child(startIndex).nodeSize;\n  }\n\n  while (endIndex < $pos.parent.childCount && isMarkInSet($pos.parent.child(endIndex).marks, type, attributes)) {\n    endPos += $pos.parent.child(endIndex).nodeSize;\n    endIndex += 1;\n  }\n\n  return {\n    from: startPos,\n    to: endPos\n  };\n}\n\nvar extendMarkRange = function extendMarkRange(typeOrName) {\n  var attributes = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return function (_ref16) {\n    var tr = _ref16.tr,\n        state = _ref16.state,\n        dispatch = _ref16.dispatch;\n    var type = getMarkType(typeOrName, state.schema);\n    var doc = tr.doc,\n        selection = tr.selection;\n    var $from = selection.$from,\n        from = selection.from,\n        to = selection.to;\n\n    if (dispatch) {\n      var range = getMarkRange($from, type, attributes);\n\n      if (range && range.from <= from && range.to >= to) {\n        var newSelection = TextSelection.create(doc, range.from, range.to);\n        tr.setSelection(newSelection);\n      }\n    }\n\n    return true;\n  };\n};\n\nvar extendMarkRange$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  extendMarkRange: extendMarkRange\n});\n\nvar first = function first(commands) {\n  return function (props) {\n    var items = typeof commands === 'function' ? commands(props) : commands;\n\n    for (var i = 0; i < items.length; i += 1) {\n      if (items[i](props)) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n};\n\nvar first$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  first: first\n});\n\nfunction isClass(value) {\n  var _a;\n\n  if (((_a = value.constructor) === null || _a === void 0 ? void 0 : _a.toString().substring(0, 5)) !== 'class') {\n    return false;\n  }\n\n  return true;\n}\n\nfunction isObject(value) {\n  return value && typeof value === 'object' && !Array.isArray(value) && !isClass(value);\n}\n\nfunction isTextSelection(value) {\n  return isObject(value) && value instanceof TextSelection;\n}\n\nfunction isiOS() {\n  return ['iPad Simulator', 'iPhone Simulator', 'iPod Simulator', 'iPad', 'iPhone', 'iPod'].includes(navigator.platform) // iPad on iOS 13 detection\n  || navigator.userAgent.includes('Mac') && 'ontouchend' in document;\n}\n\nfunction minMax() {\n  var value = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n  var min = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  var max = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n  return Math.min(Math.max(value, min), max);\n}\n\nfunction resolveFocusPosition(doc) {\n  var position = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\n  if (!position) {\n    return null;\n  }\n\n  var selectionAtStart = Selection.atStart(doc);\n  var selectionAtEnd = Selection.atEnd(doc);\n\n  if (position === 'start' || position === true) {\n    return selectionAtStart;\n  }\n\n  if (position === 'end') {\n    return selectionAtEnd;\n  }\n\n  var minPos = selectionAtStart.from;\n  var maxPos = selectionAtEnd.to;\n\n  if (position === 'all') {\n    return TextSelection.create(doc, minMax(0, minPos, maxPos), minMax(doc.content.size, minPos, maxPos));\n  }\n\n  return TextSelection.create(doc, minMax(position, minPos, maxPos), minMax(position, minPos, maxPos));\n}\n\nvar focus = function focus() {\n  var position = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n  var options = arguments.length > 1 ? arguments[1] : undefined;\n  return function (_ref17) {\n    var editor = _ref17.editor,\n        view = _ref17.view,\n        tr = _ref17.tr,\n        dispatch = _ref17.dispatch;\n    options = _objectSpread({\n      scrollIntoView: true\n    }, options);\n\n    var delayedFocus = function delayedFocus() {\n      // focus within `requestAnimationFrame` breaks focus on iOS\n      // so we have to call this\n      if (isiOS()) {\n        view.dom.focus();\n      } // For React we have to focus asynchronously. Otherwise wild things happen.\n      // see: https://github.com/ueberdosis/tiptap/issues/1520\n\n\n      requestAnimationFrame(function () {\n        if (!editor.isDestroyed) {\n          view.focus();\n\n          if (options === null || options === void 0 ? void 0 : options.scrollIntoView) {\n            editor.commands.scrollIntoView();\n          }\n        }\n      });\n    };\n\n    if (view.hasFocus() && position === null || position === false) {\n      return true;\n    } // we dont try to resolve a NodeSelection or CellSelection\n\n\n    if (dispatch && position === null && !isTextSelection(editor.state.selection)) {\n      delayedFocus();\n      return true;\n    }\n\n    var selection = resolveFocusPosition(editor.state.doc, position) || editor.state.selection;\n    var isSameSelection = editor.state.selection.eq(selection);\n\n    if (dispatch) {\n      if (!isSameSelection) {\n        tr.setSelection(selection);\n      } // `tr.setSelection` resets the stored marks\n      // so well restore them if the selection is the same as before\n\n\n      if (isSameSelection && tr.storedMarks) {\n        tr.setStoredMarks(tr.storedMarks);\n      }\n\n      delayedFocus();\n    }\n\n    return true;\n  };\n};\n\nvar focus$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  focus: focus\n});\n\nvar forEach = function forEach(items, fn) {\n  return function (props) {\n    return items.every(function (item, index) {\n      return fn(item, _objectSpread(_objectSpread({}, props), {}, {\n        index: index\n      }));\n    });\n  };\n};\n\nvar forEach$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  forEach: forEach\n});\n\nvar insertContent = function insertContent(value, options) {\n  return function (_ref18) {\n    var tr = _ref18.tr,\n        commands = _ref18.commands;\n    return commands.insertContentAt({\n      from: tr.selection.from,\n      to: tr.selection.to\n    }, value, options);\n  };\n};\n\nvar insertContent$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  insertContent: insertContent\n});\n\nfunction elementFromString(value) {\n  // add a wrapper to preserve leading and trailing whitespace\n  var wrappedValue = \"<body>\".concat(value, \"</body>\");\n  return new window.DOMParser().parseFromString(wrappedValue, 'text/html').body;\n}\n\nfunction createNodeFromContent(content, schema, options) {\n  options = _objectSpread({\n    slice: true,\n    parseOptions: {}\n  }, options);\n\n  if (typeof content === 'object' && content !== null) {\n    try {\n      if (Array.isArray(content)) {\n        return Fragment.fromArray(content.map(function (item) {\n          return schema.nodeFromJSON(item);\n        }));\n      }\n\n      return schema.nodeFromJSON(content);\n    } catch (error) {\n      console.warn('[tiptap warn]: Invalid content.', 'Passed value:', content, 'Error:', error);\n      return createNodeFromContent('', schema, options);\n    }\n  }\n\n  if (typeof content === 'string') {\n    var parser = DOMParser.fromSchema(schema);\n    return options.slice ? parser.parseSlice(elementFromString(content), options.parseOptions).content : parser.parse(elementFromString(content), options.parseOptions);\n  }\n\n  return createNodeFromContent('', schema, options);\n} // source: https://github.com/ProseMirror/prosemirror-state/blob/master/src/selection.js#L466\n\n\nfunction selectionToInsertionEnd(tr, startLen, bias) {\n  var last = tr.steps.length - 1;\n\n  if (last < startLen) {\n    return;\n  }\n\n  var step = tr.steps[last];\n\n  if (!(step instanceof ReplaceStep || step instanceof ReplaceAroundStep)) {\n    return;\n  }\n\n  var map = tr.mapping.maps[last];\n  var end = 0;\n  map.forEach(function (_from, _to, _newFrom, newTo) {\n    if (end === 0) {\n      end = newTo;\n    }\n  });\n  tr.setSelection(Selection.near(tr.doc.resolve(end), bias));\n}\n\nvar isFragment = function isFragment(nodeOrFragment) {\n  return nodeOrFragment.toString().startsWith('<');\n};\n\nvar insertContentAt = function insertContentAt(position, value, options) {\n  return function (_ref19) {\n    var tr = _ref19.tr,\n        dispatch = _ref19.dispatch,\n        editor = _ref19.editor;\n\n    if (dispatch) {\n      options = _objectSpread({\n        parseOptions: {},\n        updateSelection: true\n      }, options);\n      var content = createNodeFromContent(value, editor.schema, {\n        parseOptions: _objectSpread({\n          preserveWhitespace: 'full'\n        }, options.parseOptions)\n      }); // dont dispatch an empty fragment because this can lead to strange errors\n\n      if (content.toString() === '<>') {\n        return true;\n      }\n\n      var _ref20 = typeof position === 'number' ? {\n        from: position,\n        to: position\n      } : position,\n          from = _ref20.from,\n          to = _ref20.to;\n\n      var isOnlyTextContent = true;\n      var isOnlyBlockContent = true;\n      var nodes = isFragment(content) ? content : [content];\n      nodes.forEach(function (node) {\n        // check if added node is valid\n        node.check();\n        isOnlyTextContent = isOnlyTextContent ? node.isText && node.marks.length === 0 : false;\n        isOnlyBlockContent = isOnlyBlockContent ? node.isBlock : false;\n      }); // check if we can replace the wrapping node by\n      // the newly inserted content\n      // example:\n      // replace an empty paragraph by an inserted image\n      // instead of inserting the image below the paragraph\n\n      if (from === to && isOnlyBlockContent) {\n        var _tr$doc$resolve = tr.doc.resolve(from),\n            parent = _tr$doc$resolve.parent;\n\n        var isEmptyTextBlock = parent.isTextblock && !parent.type.spec.code && !parent.childCount;\n\n        if (isEmptyTextBlock) {\n          from -= 1;\n          to += 1;\n        }\n      } // if there is only plain text we have to use `insertText`\n      // because this will keep the current marks\n\n\n      if (isOnlyTextContent) {\n        tr.insertText(value, from, to);\n      } else {\n        tr.replaceWith(from, to, content);\n      } // set cursor at end of inserted content\n\n\n      if (options.updateSelection) {\n        selectionToInsertionEnd(tr, tr.steps.length - 1, -1);\n      }\n    }\n\n    return true;\n  };\n};\n\nvar insertContentAt$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  insertContentAt: insertContentAt\n});\n\nvar joinBackward = function joinBackward() {\n  return function (_ref21) {\n    var state = _ref21.state,\n        dispatch = _ref21.dispatch;\n    return joinBackward$2(state, dispatch);\n  };\n};\n\nvar joinBackward$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  joinBackward: joinBackward\n});\n\nvar joinForward = function joinForward() {\n  return function (_ref22) {\n    var state = _ref22.state,\n        dispatch = _ref22.dispatch;\n    return joinForward$2(state, dispatch);\n  };\n};\n\nvar joinForward$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  joinForward: joinForward\n});\n\nfunction isMacOS() {\n  return typeof navigator !== 'undefined' ? /Mac/.test(navigator.platform) : false;\n}\n\nfunction normalizeKeyName(name) {\n  var parts = name.split(/-(?!$)/);\n  var result = parts[parts.length - 1];\n\n  if (result === 'Space') {\n    result = ' ';\n  }\n\n  var alt;\n  var ctrl;\n  var shift;\n  var meta;\n\n  for (var i = 0; i < parts.length - 1; i += 1) {\n    var mod = parts[i];\n\n    if (/^(cmd|meta|m)$/i.test(mod)) {\n      meta = true;\n    } else if (/^a(lt)?$/i.test(mod)) {\n      alt = true;\n    } else if (/^(c|ctrl|control)$/i.test(mod)) {\n      ctrl = true;\n    } else if (/^s(hift)?$/i.test(mod)) {\n      shift = true;\n    } else if (/^mod$/i.test(mod)) {\n      if (isiOS() || isMacOS()) {\n        meta = true;\n      } else {\n        ctrl = true;\n      }\n    } else {\n      throw new Error(\"Unrecognized modifier name: \".concat(mod));\n    }\n  }\n\n  if (alt) {\n    result = \"Alt-\".concat(result);\n  }\n\n  if (ctrl) {\n    result = \"Ctrl-\".concat(result);\n  }\n\n  if (meta) {\n    result = \"Meta-\".concat(result);\n  }\n\n  if (shift) {\n    result = \"Shift-\".concat(result);\n  }\n\n  return result;\n}\n\nvar keyboardShortcut = function keyboardShortcut(name) {\n  return function (_ref23) {\n    var editor = _ref23.editor,\n        view = _ref23.view,\n        tr = _ref23.tr,\n        dispatch = _ref23.dispatch;\n    var keys = normalizeKeyName(name).split(/-(?!$)/);\n    var key = keys.find(function (item) {\n      return !['Alt', 'Ctrl', 'Meta', 'Shift'].includes(item);\n    });\n    var event = new KeyboardEvent('keydown', {\n      key: key === 'Space' ? ' ' : key,\n      altKey: keys.includes('Alt'),\n      ctrlKey: keys.includes('Ctrl'),\n      metaKey: keys.includes('Meta'),\n      shiftKey: keys.includes('Shift'),\n      bubbles: true,\n      cancelable: true\n    });\n    var capturedTransaction = editor.captureTransaction(function () {\n      view.someProp('handleKeyDown', function (f) {\n        return f(view, event);\n      });\n    });\n    capturedTransaction === null || capturedTransaction === void 0 ? void 0 : capturedTransaction.steps.forEach(function (step) {\n      var newStep = step.map(tr.mapping);\n\n      if (newStep && dispatch) {\n        tr.maybeStep(newStep);\n      }\n    });\n    return true;\n  };\n};\n\nvar keyboardShortcut$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  keyboardShortcut: keyboardShortcut\n});\n\nfunction isNodeActive(state, typeOrName) {\n  var attributes = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var _state$selection = state.selection,\n      from = _state$selection.from,\n      to = _state$selection.to,\n      empty = _state$selection.empty;\n  var type = typeOrName ? getNodeType(typeOrName, state.schema) : null;\n  var nodeRanges = [];\n  state.doc.nodesBetween(from, to, function (node, pos) {\n    if (node.isText) {\n      return;\n    }\n\n    var relativeFrom = Math.max(from, pos);\n    var relativeTo = Math.min(to, pos + node.nodeSize);\n    nodeRanges.push({\n      node: node,\n      from: relativeFrom,\n      to: relativeTo\n    });\n  });\n  var selectionRange = to - from;\n  var matchedNodeRanges = nodeRanges.filter(function (nodeRange) {\n    if (!type) {\n      return true;\n    }\n\n    return type.name === nodeRange.node.type.name;\n  }).filter(function (nodeRange) {\n    return objectIncludes(nodeRange.node.attrs, attributes, {\n      strict: false\n    });\n  });\n\n  if (empty) {\n    return !!matchedNodeRanges.length;\n  }\n\n  var range = matchedNodeRanges.reduce(function (sum, nodeRange) {\n    return sum + nodeRange.to - nodeRange.from;\n  }, 0);\n  return range >= selectionRange;\n}\n\nvar lift = function lift(typeOrName) {\n  var attributes = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return function (_ref24) {\n    var state = _ref24.state,\n        dispatch = _ref24.dispatch;\n    var type = getNodeType(typeOrName, state.schema);\n    var isActive = isNodeActive(state, type, attributes);\n\n    if (!isActive) {\n      return false;\n    }\n\n    return lift$2(state, dispatch);\n  };\n};\n\nvar lift$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  lift: lift\n});\n\nvar liftEmptyBlock = function liftEmptyBlock() {\n  return function (_ref25) {\n    var state = _ref25.state,\n        dispatch = _ref25.dispatch;\n    return liftEmptyBlock$2(state, dispatch);\n  };\n};\n\nvar liftEmptyBlock$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  liftEmptyBlock: liftEmptyBlock\n});\n\nvar liftListItem = function liftListItem(typeOrName) {\n  return function (_ref26) {\n    var state = _ref26.state,\n        dispatch = _ref26.dispatch;\n    var type = getNodeType(typeOrName, state.schema);\n    return liftListItem$2(type)(state, dispatch);\n  };\n};\n\nvar liftListItem$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  liftListItem: liftListItem\n});\n\nvar newlineInCode = function newlineInCode() {\n  return function (_ref27) {\n    var state = _ref27.state,\n        dispatch = _ref27.dispatch;\n    return newlineInCode$2(state, dispatch);\n  };\n};\n\nvar newlineInCode$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  newlineInCode: newlineInCode\n});\n\nfunction getSchemaTypeNameByName(name, schema) {\n  if (schema.nodes[name]) {\n    return 'node';\n  }\n\n  if (schema.marks[name]) {\n    return 'mark';\n  }\n\n  return null;\n}\n/**\r\n * Remove a property or an array of properties from an object\r\n * @param obj Object\r\n * @param key Key to remove\r\n */\n\n\nfunction deleteProps(obj, propOrProps) {\n  var props = typeof propOrProps === 'string' ? [propOrProps] : propOrProps;\n  return Object.keys(obj).reduce(function (newObj, prop) {\n    if (!props.includes(prop)) {\n      newObj[prop] = obj[prop];\n    }\n\n    return newObj;\n  }, {});\n}\n\nvar resetAttributes = function resetAttributes(typeOrName, attributes) {\n  return function (_ref28) {\n    var tr = _ref28.tr,\n        state = _ref28.state,\n        dispatch = _ref28.dispatch;\n    var nodeType = null;\n    var markType = null;\n    var schemaType = getSchemaTypeNameByName(typeof typeOrName === 'string' ? typeOrName : typeOrName.name, state.schema);\n\n    if (!schemaType) {\n      return false;\n    }\n\n    if (schemaType === 'node') {\n      nodeType = getNodeType(typeOrName, state.schema);\n    }\n\n    if (schemaType === 'mark') {\n      markType = getMarkType(typeOrName, state.schema);\n    }\n\n    if (dispatch) {\n      tr.selection.ranges.forEach(function (range) {\n        state.doc.nodesBetween(range.$from.pos, range.$to.pos, function (node, pos) {\n          if (nodeType && nodeType === node.type) {\n            tr.setNodeMarkup(pos, undefined, deleteProps(node.attrs, attributes));\n          }\n\n          if (markType && node.marks.length) {\n            node.marks.forEach(function (mark) {\n              if (markType === mark.type) {\n                tr.addMark(pos, pos + node.nodeSize, markType.create(deleteProps(mark.attrs, attributes)));\n              }\n            });\n          }\n        });\n      });\n    }\n\n    return true;\n  };\n};\n\nvar resetAttributes$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  resetAttributes: resetAttributes\n});\n\nvar scrollIntoView = function scrollIntoView() {\n  return function (_ref29) {\n    var tr = _ref29.tr,\n        dispatch = _ref29.dispatch;\n\n    if (dispatch) {\n      tr.scrollIntoView();\n    }\n\n    return true;\n  };\n};\n\nvar scrollIntoView$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  scrollIntoView: scrollIntoView\n});\n\nvar selectAll = function selectAll() {\n  return function (_ref30) {\n    var tr = _ref30.tr,\n        commands = _ref30.commands;\n    return commands.setTextSelection({\n      from: 0,\n      to: tr.doc.content.size\n    });\n  };\n};\n\nvar selectAll$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  selectAll: selectAll\n});\n\nvar selectNodeBackward = function selectNodeBackward() {\n  return function (_ref31) {\n    var state = _ref31.state,\n        dispatch = _ref31.dispatch;\n    return selectNodeBackward$2(state, dispatch);\n  };\n};\n\nvar selectNodeBackward$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  selectNodeBackward: selectNodeBackward\n});\n\nvar selectNodeForward = function selectNodeForward() {\n  return function (_ref32) {\n    var state = _ref32.state,\n        dispatch = _ref32.dispatch;\n    return selectNodeForward$2(state, dispatch);\n  };\n};\n\nvar selectNodeForward$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  selectNodeForward: selectNodeForward\n});\n\nvar selectParentNode = function selectParentNode() {\n  return function (_ref33) {\n    var state = _ref33.state,\n        dispatch = _ref33.dispatch;\n    return selectParentNode$2(state, dispatch);\n  };\n};\n\nvar selectParentNode$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  selectParentNode: selectParentNode\n}); // @ts-ignore\n\nvar selectTextblockEnd = function selectTextblockEnd() {\n  return function (_ref34) {\n    var state = _ref34.state,\n        dispatch = _ref34.dispatch;\n    return selectTextblockEnd$2(state, dispatch);\n  };\n};\n\nvar selectTextblockEnd$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  selectTextblockEnd: selectTextblockEnd\n}); // @ts-ignore\n\nvar selectTextblockStart = function selectTextblockStart() {\n  return function (_ref35) {\n    var state = _ref35.state,\n        dispatch = _ref35.dispatch;\n    return selectTextblockStart$2(state, dispatch);\n  };\n};\n\nvar selectTextblockStart$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  selectTextblockStart: selectTextblockStart\n});\n\nfunction createDocument(content, schema) {\n  var parseOptions = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return createNodeFromContent(content, schema, {\n    slice: false,\n    parseOptions: parseOptions\n  });\n}\n\nvar setContent = function setContent(content) {\n  var emitUpdate = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  var parseOptions = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return function (_ref36) {\n    var tr = _ref36.tr,\n        editor = _ref36.editor,\n        dispatch = _ref36.dispatch;\n    var doc = tr.doc;\n    var document = createDocument(content, editor.schema, parseOptions);\n    var selection = TextSelection.create(doc, 0, doc.content.size);\n\n    if (dispatch) {\n      tr.setSelection(selection).replaceSelectionWith(document, false).setMeta('preventUpdate', !emitUpdate);\n    }\n\n    return true;\n  };\n};\n\nvar setContent$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  setContent: setContent\n});\n\nfunction getMarkAttributes(state, typeOrName) {\n  var type = getMarkType(typeOrName, state.schema);\n  var _state$selection2 = state.selection,\n      from = _state$selection2.from,\n      to = _state$selection2.to,\n      empty = _state$selection2.empty;\n  var marks = [];\n\n  if (empty) {\n    if (state.storedMarks) {\n      marks.push.apply(marks, _toConsumableArray(state.storedMarks));\n    }\n\n    marks.push.apply(marks, _toConsumableArray(state.selection.$head.marks()));\n  } else {\n    state.doc.nodesBetween(from, to, function (node) {\n      marks.push.apply(marks, _toConsumableArray(node.marks));\n    });\n  }\n\n  var mark = marks.find(function (markItem) {\n    return markItem.type.name === type.name;\n  });\n\n  if (!mark) {\n    return {};\n  }\n\n  return _objectSpread({}, mark.attrs);\n}\n\nvar setMark = function setMark(typeOrName) {\n  var attributes = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return function (_ref37) {\n    var tr = _ref37.tr,\n        state = _ref37.state,\n        dispatch = _ref37.dispatch;\n    var selection = tr.selection;\n    var empty = selection.empty,\n        ranges = selection.ranges;\n    var type = getMarkType(typeOrName, state.schema);\n\n    if (dispatch) {\n      if (empty) {\n        var oldAttributes = getMarkAttributes(state, type);\n        tr.addStoredMark(type.create(_objectSpread(_objectSpread({}, oldAttributes), attributes)));\n      } else {\n        ranges.forEach(function (range) {\n          var from = range.$from.pos;\n          var to = range.$to.pos;\n          state.doc.nodesBetween(from, to, function (node, pos) {\n            var trimmedFrom = Math.max(pos, from);\n            var trimmedTo = Math.min(pos + node.nodeSize, to);\n            var someHasMark = node.marks.find(function (mark) {\n              return mark.type === type;\n            }); // if there is already a mark of this type\n            // we know that we have to merge its attributes\n            // otherwise we add a fresh new mark\n\n            if (someHasMark) {\n              node.marks.forEach(function (mark) {\n                if (type === mark.type) {\n                  tr.addMark(trimmedFrom, trimmedTo, type.create(_objectSpread(_objectSpread({}, mark.attrs), attributes)));\n                }\n              });\n            } else {\n              tr.addMark(trimmedFrom, trimmedTo, type.create(attributes));\n            }\n          });\n        });\n      }\n    }\n\n    return true;\n  };\n};\n\nvar setMark$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  setMark: setMark\n});\n\nvar setMeta = function setMeta(key, value) {\n  return function (_ref38) {\n    var tr = _ref38.tr;\n    tr.setMeta(key, value);\n    return true;\n  };\n};\n\nvar setMeta$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  setMeta: setMeta\n});\n\nvar setNode = function setNode(typeOrName) {\n  var attributes = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return function (_ref39) {\n    var state = _ref39.state,\n        dispatch = _ref39.dispatch,\n        chain = _ref39.chain;\n    var type = getNodeType(typeOrName, state.schema); // TODO: use a fallback like insertContent?\n\n    if (!type.isTextblock) {\n      console.warn('[tiptap warn]: Currently \"setNode()\" only supports text block nodes.');\n      return false;\n    }\n\n    return chain() // try to convert node to default node if needed\n    .command(function (_ref40) {\n      var commands = _ref40.commands;\n      var canSetBlock = setBlockType(type, attributes)(state);\n\n      if (canSetBlock) {\n        return true;\n      }\n\n      return commands.clearNodes();\n    }).command(function (_ref41) {\n      var updatedState = _ref41.state;\n      return setBlockType(type, attributes)(updatedState, dispatch);\n    }).run();\n  };\n};\n\nvar setNode$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  setNode: setNode\n});\n\nvar setNodeSelection = function setNodeSelection(position) {\n  return function (_ref42) {\n    var tr = _ref42.tr,\n        dispatch = _ref42.dispatch;\n\n    if (dispatch) {\n      var doc = tr.doc;\n      var minPos = Selection.atStart(doc).from;\n      var maxPos = Selection.atEnd(doc).to;\n      var resolvedPos = minMax(position, minPos, maxPos);\n      var selection = NodeSelection.create(doc, resolvedPos);\n      tr.setSelection(selection);\n    }\n\n    return true;\n  };\n};\n\nvar setNodeSelection$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  setNodeSelection: setNodeSelection\n});\n\nvar setTextSelection = function setTextSelection(position) {\n  return function (_ref43) {\n    var tr = _ref43.tr,\n        dispatch = _ref43.dispatch;\n\n    if (dispatch) {\n      var doc = tr.doc;\n\n      var _ref44 = typeof position === 'number' ? {\n        from: position,\n        to: position\n      } : position,\n          from = _ref44.from,\n          to = _ref44.to;\n\n      var minPos = TextSelection.atStart(doc).from;\n      var maxPos = TextSelection.atEnd(doc).to;\n      var resolvedFrom = minMax(from, minPos, maxPos);\n      var resolvedEnd = minMax(to, minPos, maxPos);\n      var selection = TextSelection.create(doc, resolvedFrom, resolvedEnd);\n      tr.setSelection(selection);\n    }\n\n    return true;\n  };\n};\n\nvar setTextSelection$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  setTextSelection: setTextSelection\n});\n\nvar sinkListItem = function sinkListItem(typeOrName) {\n  return function (_ref45) {\n    var state = _ref45.state,\n        dispatch = _ref45.dispatch;\n    var type = getNodeType(typeOrName, state.schema);\n    return sinkListItem$2(type)(state, dispatch);\n  };\n};\n\nvar sinkListItem$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  sinkListItem: sinkListItem\n});\n\nfunction getSplittedAttributes(extensionAttributes, typeName, attributes) {\n  return Object.fromEntries(Object.entries(attributes).filter(function (_ref46) {\n    var _ref47 = _slicedToArray(_ref46, 1),\n        name = _ref47[0];\n\n    var extensionAttribute = extensionAttributes.find(function (item) {\n      return item.type === typeName && item.name === name;\n    });\n\n    if (!extensionAttribute) {\n      return false;\n    }\n\n    return extensionAttribute.attribute.keepOnSplit;\n  }));\n}\n\nfunction defaultBlockAt$1(match) {\n  for (var i = 0; i < match.edgeCount; i += 1) {\n    var _match$edge = match.edge(i),\n        type = _match$edge.type;\n\n    if (type.isTextblock && !type.hasRequiredAttrs()) {\n      return type;\n    }\n  }\n\n  return null;\n}\n\nfunction ensureMarks(state, splittableMarks) {\n  var marks = state.storedMarks || state.selection.$to.parentOffset && state.selection.$from.marks();\n\n  if (marks) {\n    var filteredMarks = marks.filter(function (mark) {\n      return splittableMarks === null || splittableMarks === void 0 ? void 0 : splittableMarks.includes(mark.type.name);\n    });\n    state.tr.ensureMarks(filteredMarks);\n  }\n}\n\nvar splitBlock = function splitBlock() {\n  var _ref48 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      _ref48$keepMarks = _ref48.keepMarks,\n      keepMarks = _ref48$keepMarks === void 0 ? true : _ref48$keepMarks;\n\n  return function (_ref49) {\n    var tr = _ref49.tr,\n        state = _ref49.state,\n        dispatch = _ref49.dispatch,\n        editor = _ref49.editor;\n    var selection = tr.selection,\n        doc = tr.doc;\n    var $from = selection.$from,\n        $to = selection.$to;\n    var extensionAttributes = editor.extensionManager.attributes;\n    var newAttributes = getSplittedAttributes(extensionAttributes, $from.node().type.name, $from.node().attrs);\n\n    if (selection instanceof NodeSelection && selection.node.isBlock) {\n      if (!$from.parentOffset || !canSplit(doc, $from.pos)) {\n        return false;\n      }\n\n      if (dispatch) {\n        if (keepMarks) {\n          ensureMarks(state, editor.extensionManager.splittableMarks);\n        }\n\n        tr.split($from.pos).scrollIntoView();\n      }\n\n      return true;\n    }\n\n    if (!$from.parent.isBlock) {\n      return false;\n    }\n\n    if (dispatch) {\n      var atEnd = $to.parentOffset === $to.parent.content.size;\n\n      if (selection instanceof TextSelection) {\n        tr.deleteSelection();\n      }\n\n      var deflt = $from.depth === 0 ? undefined : defaultBlockAt$1($from.node(-1).contentMatchAt($from.indexAfter(-1)));\n      var types = atEnd && deflt ? [{\n        type: deflt,\n        attrs: newAttributes\n      }] : undefined;\n      var can = canSplit(tr.doc, tr.mapping.map($from.pos), 1, types);\n\n      if (!types && !can && canSplit(tr.doc, tr.mapping.map($from.pos), 1, deflt ? [{\n        type: deflt\n      }] : undefined)) {\n        can = true;\n        types = deflt ? [{\n          type: deflt,\n          attrs: newAttributes\n        }] : undefined;\n      }\n\n      if (can) {\n        tr.split(tr.mapping.map($from.pos), 1, types);\n\n        if (deflt && !atEnd && !$from.parentOffset && $from.parent.type !== deflt) {\n          var _first = tr.mapping.map($from.before());\n\n          var $first = tr.doc.resolve(_first);\n\n          if ($from.node(-1).canReplaceWith($first.index(), $first.index() + 1, deflt)) {\n            tr.setNodeMarkup(tr.mapping.map($from.before()), deflt);\n          }\n        }\n      }\n\n      if (keepMarks) {\n        ensureMarks(state, editor.extensionManager.splittableMarks);\n      }\n\n      tr.scrollIntoView();\n    }\n\n    return true;\n  };\n};\n\nvar splitBlock$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  splitBlock: splitBlock\n});\n\nvar splitListItem = function splitListItem(typeOrName) {\n  return function (_ref50) {\n    var tr = _ref50.tr,\n        state = _ref50.state,\n        dispatch = _ref50.dispatch,\n        editor = _ref50.editor;\n\n    var _a;\n\n    var type = getNodeType(typeOrName, state.schema);\n    var _state$selection3 = state.selection,\n        $from = _state$selection3.$from,\n        $to = _state$selection3.$to; // @ts-ignore\n    // eslint-disable-next-line\n\n    var node = state.selection.node;\n\n    if (node && node.isBlock || $from.depth < 2 || !$from.sameParent($to)) {\n      return false;\n    }\n\n    var grandParent = $from.node(-1);\n\n    if (grandParent.type !== type) {\n      return false;\n    }\n\n    var extensionAttributes = editor.extensionManager.attributes;\n\n    if ($from.parent.content.size === 0 && $from.node(-1).childCount === $from.indexAfter(-1)) {\n      // In an empty block. If this is a nested list, the wrapping\n      // list item should be split. Otherwise, bail out and let next\n      // command handle lifting.\n      if ($from.depth === 2 || $from.node(-3).type !== type || $from.index(-2) !== $from.node(-2).childCount - 1) {\n        return false;\n      }\n\n      if (dispatch) {\n        var wrap = Fragment.empty; // eslint-disable-next-line\n\n        var depthBefore = $from.index(-1) ? 1 : $from.index(-2) ? 2 : 3; // Build a fragment containing empty versions of the structure\n        // from the outer list item to the parent node of the cursor\n\n        for (var d = $from.depth - depthBefore; d >= $from.depth - 3; d -= 1) {\n          wrap = Fragment.from($from.node(d).copy(wrap));\n        } // eslint-disable-next-line\n\n\n        var depthAfter = $from.indexAfter(-1) < $from.node(-2).childCount ? 1 : $from.indexAfter(-2) < $from.node(-3).childCount ? 2 : 3; // Add a second list item with an empty default start node\n\n        var _newNextTypeAttributes = getSplittedAttributes(extensionAttributes, $from.node().type.name, $from.node().attrs);\n\n        var _nextType = ((_a = type.contentMatch.defaultType) === null || _a === void 0 ? void 0 : _a.createAndFill(_newNextTypeAttributes)) || undefined;\n\n        wrap = wrap.append(Fragment.from(type.createAndFill(null, _nextType) || undefined));\n        var start = $from.before($from.depth - (depthBefore - 1));\n        tr.replace(start, $from.after(-depthAfter), new Slice(wrap, 4 - depthBefore, 0));\n        var sel = -1;\n        tr.doc.nodesBetween(start, tr.doc.content.size, function (n, pos) {\n          if (sel > -1) {\n            return false;\n          }\n\n          if (n.isTextblock && n.content.size === 0) {\n            sel = pos + 1;\n          }\n        });\n\n        if (sel > -1) {\n          tr.setSelection(TextSelection.near(tr.doc.resolve(sel)));\n        }\n\n        tr.scrollIntoView();\n      }\n\n      return true;\n    }\n\n    var nextType = $to.pos === $from.end() ? grandParent.contentMatchAt(0).defaultType : null;\n    var newTypeAttributes = getSplittedAttributes(extensionAttributes, grandParent.type.name, grandParent.attrs);\n    var newNextTypeAttributes = getSplittedAttributes(extensionAttributes, $from.node().type.name, $from.node().attrs);\n    tr.delete($from.pos, $to.pos);\n    var types = nextType ? [{\n      type: type,\n      attrs: newTypeAttributes\n    }, {\n      type: nextType,\n      attrs: newNextTypeAttributes\n    }] : [{\n      type: type,\n      attrs: newTypeAttributes\n    }];\n\n    if (!canSplit(tr.doc, $from.pos, 2)) {\n      return false;\n    }\n\n    if (dispatch) {\n      tr.split($from.pos, 2, types).scrollIntoView();\n    }\n\n    return true;\n  };\n};\n\nvar splitListItem$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  splitListItem: splitListItem\n});\n\nfunction findParentNodeClosestToPos($pos, predicate) {\n  for (var i = $pos.depth; i > 0; i -= 1) {\n    var node = $pos.node(i);\n\n    if (predicate(node)) {\n      return {\n        pos: i > 0 ? $pos.before(i) : 0,\n        start: $pos.start(i),\n        depth: i,\n        node: node\n      };\n    }\n  }\n}\n\nfunction findParentNode(predicate) {\n  return function (selection) {\n    return findParentNodeClosestToPos(selection.$from, predicate);\n  };\n}\n\nfunction splitExtensions(extensions) {\n  var baseExtensions = extensions.filter(function (extension) {\n    return extension.type === 'extension';\n  });\n  var nodeExtensions = extensions.filter(function (extension) {\n    return extension.type === 'node';\n  });\n  var markExtensions = extensions.filter(function (extension) {\n    return extension.type === 'mark';\n  });\n  return {\n    baseExtensions: baseExtensions,\n    nodeExtensions: nodeExtensions,\n    markExtensions: markExtensions\n  };\n}\n\nfunction isList(name, extensions) {\n  var _splitExtensions = splitExtensions(extensions),\n      nodeExtensions = _splitExtensions.nodeExtensions;\n\n  var extension = nodeExtensions.find(function (item) {\n    return item.name === name;\n  });\n\n  if (!extension) {\n    return false;\n  }\n\n  var context = {\n    name: extension.name,\n    options: extension.options,\n    storage: extension.storage\n  };\n  var group = callOrReturn(getExtensionField(extension, 'group', context));\n\n  if (typeof group !== 'string') {\n    return false;\n  }\n\n  return group.split(' ').includes('list');\n}\n\nvar joinListBackwards = function joinListBackwards(tr, listType) {\n  var list = findParentNode(function (node) {\n    return node.type === listType;\n  })(tr.selection);\n\n  if (!list) {\n    return true;\n  }\n\n  var before = tr.doc.resolve(Math.max(0, list.pos - 1)).before(list.depth);\n\n  if (before === undefined) {\n    return true;\n  }\n\n  var nodeBefore = tr.doc.nodeAt(before);\n  var canJoinBackwards = list.node.type === (nodeBefore === null || nodeBefore === void 0 ? void 0 : nodeBefore.type) && canJoin(tr.doc, list.pos);\n\n  if (!canJoinBackwards) {\n    return true;\n  }\n\n  tr.join(list.pos);\n  return true;\n};\n\nvar joinListForwards = function joinListForwards(tr, listType) {\n  var list = findParentNode(function (node) {\n    return node.type === listType;\n  })(tr.selection);\n\n  if (!list) {\n    return true;\n  }\n\n  var after = tr.doc.resolve(list.start).after(list.depth);\n\n  if (after === undefined) {\n    return true;\n  }\n\n  var nodeAfter = tr.doc.nodeAt(after);\n  var canJoinForwards = list.node.type === (nodeAfter === null || nodeAfter === void 0 ? void 0 : nodeAfter.type) && canJoin(tr.doc, after);\n\n  if (!canJoinForwards) {\n    return true;\n  }\n\n  tr.join(after);\n  return true;\n};\n\nvar toggleList = function toggleList(listTypeOrName, itemTypeOrName) {\n  return function (_ref51) {\n    var editor = _ref51.editor,\n        tr = _ref51.tr,\n        state = _ref51.state,\n        dispatch = _ref51.dispatch,\n        chain = _ref51.chain,\n        commands = _ref51.commands,\n        can = _ref51.can;\n    var extensions = editor.extensionManager.extensions;\n    var listType = getNodeType(listTypeOrName, state.schema);\n    var itemType = getNodeType(itemTypeOrName, state.schema);\n    var selection = state.selection;\n    var $from = selection.$from,\n        $to = selection.$to;\n    var range = $from.blockRange($to);\n\n    if (!range) {\n      return false;\n    }\n\n    var parentList = findParentNode(function (node) {\n      return isList(node.type.name, extensions);\n    })(selection);\n\n    if (range.depth >= 1 && parentList && range.depth - parentList.depth <= 1) {\n      // remove list\n      if (parentList.node.type === listType) {\n        return commands.liftListItem(itemType);\n      } // change list type\n\n\n      if (isList(parentList.node.type.name, extensions) && listType.validContent(parentList.node.content) && dispatch) {\n        return chain().command(function () {\n          tr.setNodeMarkup(parentList.pos, listType);\n          return true;\n        }).command(function () {\n          return joinListBackwards(tr, listType);\n        }).command(function () {\n          return joinListForwards(tr, listType);\n        }).run();\n      }\n    }\n\n    return chain() // try to convert node to default node if needed\n    .command(function () {\n      var canWrapInList = can().wrapInList(listType);\n\n      if (canWrapInList) {\n        return true;\n      }\n\n      return commands.clearNodes();\n    }).wrapInList(listType).command(function () {\n      return joinListBackwards(tr, listType);\n    }).command(function () {\n      return joinListForwards(tr, listType);\n    }).run();\n  };\n};\n\nvar toggleList$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  toggleList: toggleList\n});\n\nfunction isMarkActive(state, typeOrName) {\n  var attributes = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var _state$selection4 = state.selection,\n      empty = _state$selection4.empty,\n      ranges = _state$selection4.ranges;\n  var type = typeOrName ? getMarkType(typeOrName, state.schema) : null;\n\n  if (empty) {\n    return !!(state.storedMarks || state.selection.$from.marks()).filter(function (mark) {\n      if (!type) {\n        return true;\n      }\n\n      return type.name === mark.type.name;\n    }).find(function (mark) {\n      return objectIncludes(mark.attrs, attributes, {\n        strict: false\n      });\n    });\n  }\n\n  var selectionRange = 0;\n  var markRanges = [];\n  ranges.forEach(function (_ref52) {\n    var $from = _ref52.$from,\n        $to = _ref52.$to;\n    var from = $from.pos;\n    var to = $to.pos;\n    state.doc.nodesBetween(from, to, function (node, pos) {\n      if (!node.isText && !node.marks.length) {\n        return;\n      }\n\n      var relativeFrom = Math.max(from, pos);\n      var relativeTo = Math.min(to, pos + node.nodeSize);\n      var range = relativeTo - relativeFrom;\n      selectionRange += range;\n      markRanges.push.apply(markRanges, _toConsumableArray(node.marks.map(function (mark) {\n        return {\n          mark: mark,\n          from: relativeFrom,\n          to: relativeTo\n        };\n      })));\n    });\n  });\n\n  if (selectionRange === 0) {\n    return false;\n  } // calculate range of matched mark\n\n\n  var matchedRange = markRanges.filter(function (markRange) {\n    if (!type) {\n      return true;\n    }\n\n    return type.name === markRange.mark.type.name;\n  }).filter(function (markRange) {\n    return objectIncludes(markRange.mark.attrs, attributes, {\n      strict: false\n    });\n  }).reduce(function (sum, markRange) {\n    return sum + markRange.to - markRange.from;\n  }, 0); // calculate range of marks that excludes the searched mark\n  // for example `code` doesnt allow any other marks\n\n  var excludedRange = markRanges.filter(function (markRange) {\n    if (!type) {\n      return true;\n    }\n\n    return markRange.mark.type !== type && markRange.mark.type.excludes(type);\n  }).reduce(function (sum, markRange) {\n    return sum + markRange.to - markRange.from;\n  }, 0); // we only include the result of `excludedRange`\n  // if there is a match at all\n\n  var range = matchedRange > 0 ? matchedRange + excludedRange : matchedRange;\n  return range >= selectionRange;\n}\n\nvar toggleMark = function toggleMark(typeOrName) {\n  var attributes = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return function (_ref53) {\n    var state = _ref53.state,\n        commands = _ref53.commands;\n    var _options$extendEmptyM = options.extendEmptyMarkRange,\n        extendEmptyMarkRange = _options$extendEmptyM === void 0 ? false : _options$extendEmptyM;\n    var type = getMarkType(typeOrName, state.schema);\n    var isActive = isMarkActive(state, type, attributes);\n\n    if (isActive) {\n      return commands.unsetMark(type, {\n        extendEmptyMarkRange: extendEmptyMarkRange\n      });\n    }\n\n    return commands.setMark(type, attributes);\n  };\n};\n\nvar toggleMark$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  toggleMark: toggleMark\n});\n\nvar toggleNode = function toggleNode(typeOrName, toggleTypeOrName) {\n  var attributes = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return function (_ref54) {\n    var state = _ref54.state,\n        commands = _ref54.commands;\n    var type = getNodeType(typeOrName, state.schema);\n    var toggleType = getNodeType(toggleTypeOrName, state.schema);\n    var isActive = isNodeActive(state, type, attributes);\n\n    if (isActive) {\n      return commands.setNode(toggleType);\n    }\n\n    return commands.setNode(type, attributes);\n  };\n};\n\nvar toggleNode$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  toggleNode: toggleNode\n});\n\nvar toggleWrap = function toggleWrap(typeOrName) {\n  var attributes = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return function (_ref55) {\n    var state = _ref55.state,\n        commands = _ref55.commands;\n    var type = getNodeType(typeOrName, state.schema);\n    var isActive = isNodeActive(state, type, attributes);\n\n    if (isActive) {\n      return commands.lift(type);\n    }\n\n    return commands.wrapIn(type, attributes);\n  };\n};\n\nvar toggleWrap$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  toggleWrap: toggleWrap\n});\n\nvar undoInputRule = function undoInputRule() {\n  return function (_ref56) {\n    var state = _ref56.state,\n        dispatch = _ref56.dispatch;\n    var plugins = state.plugins;\n\n    for (var i = 0; i < plugins.length; i += 1) {\n      var plugin = plugins[i];\n      var undoable = void 0; // @ts-ignore\n      // eslint-disable-next-line\n\n      if (plugin.spec.isInputRules && (undoable = plugin.getState(state))) {\n        if (dispatch) {\n          var tr = state.tr;\n          var toUndo = undoable.transform;\n\n          for (var j = toUndo.steps.length - 1; j >= 0; j -= 1) {\n            tr.step(toUndo.steps[j].invert(toUndo.docs[j]));\n          }\n\n          if (undoable.text) {\n            var marks = tr.doc.resolve(undoable.from).marks();\n            tr.replaceWith(undoable.from, undoable.to, state.schema.text(undoable.text, marks));\n          } else {\n            tr.delete(undoable.from, undoable.to);\n          }\n        }\n\n        return true;\n      }\n    }\n\n    return false;\n  };\n};\n\nvar undoInputRule$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  undoInputRule: undoInputRule\n});\n\nvar unsetAllMarks = function unsetAllMarks() {\n  return function (_ref57) {\n    var tr = _ref57.tr,\n        dispatch = _ref57.dispatch;\n    var selection = tr.selection;\n    var empty = selection.empty,\n        ranges = selection.ranges;\n\n    if (empty) {\n      return true;\n    }\n\n    if (dispatch) {\n      ranges.forEach(function (range) {\n        tr.removeMark(range.$from.pos, range.$to.pos);\n      });\n    }\n\n    return true;\n  };\n};\n\nvar unsetAllMarks$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  unsetAllMarks: unsetAllMarks\n});\n\nvar unsetMark = function unsetMark(typeOrName) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return function (_ref58) {\n    var tr = _ref58.tr,\n        state = _ref58.state,\n        dispatch = _ref58.dispatch;\n\n    var _a;\n\n    var _options$extendEmptyM2 = options.extendEmptyMarkRange,\n        extendEmptyMarkRange = _options$extendEmptyM2 === void 0 ? false : _options$extendEmptyM2;\n    var selection = tr.selection;\n    var type = getMarkType(typeOrName, state.schema);\n    var $from = selection.$from,\n        empty = selection.empty,\n        ranges = selection.ranges;\n\n    if (!dispatch) {\n      return true;\n    }\n\n    if (empty && extendEmptyMarkRange) {\n      var from = selection.from,\n          to = selection.to;\n      var attrs = (_a = $from.marks().find(function (mark) {\n        return mark.type === type;\n      })) === null || _a === void 0 ? void 0 : _a.attrs;\n      var range = getMarkRange($from, type, attrs);\n\n      if (range) {\n        from = range.from;\n        to = range.to;\n      }\n\n      tr.removeMark(from, to, type);\n    } else {\n      ranges.forEach(function (range) {\n        tr.removeMark(range.$from.pos, range.$to.pos, type);\n      });\n    }\n\n    tr.removeStoredMark(type);\n    return true;\n  };\n};\n\nvar unsetMark$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  unsetMark: unsetMark\n});\n\nvar updateAttributes = function updateAttributes(typeOrName) {\n  var attributes = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return function (_ref59) {\n    var tr = _ref59.tr,\n        state = _ref59.state,\n        dispatch = _ref59.dispatch;\n    var nodeType = null;\n    var markType = null;\n    var schemaType = getSchemaTypeNameByName(typeof typeOrName === 'string' ? typeOrName : typeOrName.name, state.schema);\n\n    if (!schemaType) {\n      return false;\n    }\n\n    if (schemaType === 'node') {\n      nodeType = getNodeType(typeOrName, state.schema);\n    }\n\n    if (schemaType === 'mark') {\n      markType = getMarkType(typeOrName, state.schema);\n    }\n\n    if (dispatch) {\n      tr.selection.ranges.forEach(function (range) {\n        var from = range.$from.pos;\n        var to = range.$to.pos;\n        state.doc.nodesBetween(from, to, function (node, pos) {\n          if (nodeType && nodeType === node.type) {\n            tr.setNodeMarkup(pos, undefined, _objectSpread(_objectSpread({}, node.attrs), attributes));\n          }\n\n          if (markType && node.marks.length) {\n            node.marks.forEach(function (mark) {\n              if (markType === mark.type) {\n                var trimmedFrom = Math.max(pos, from);\n                var trimmedTo = Math.min(pos + node.nodeSize, to);\n                tr.addMark(trimmedFrom, trimmedTo, markType.create(_objectSpread(_objectSpread({}, mark.attrs), attributes)));\n              }\n            });\n          }\n        });\n      });\n    }\n\n    return true;\n  };\n};\n\nvar updateAttributes$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  updateAttributes: updateAttributes\n});\n\nvar wrapIn = function wrapIn(typeOrName) {\n  var attributes = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return function (_ref60) {\n    var state = _ref60.state,\n        dispatch = _ref60.dispatch;\n    var type = getNodeType(typeOrName, state.schema);\n    return wrapIn$2(type, attributes)(state, dispatch);\n  };\n};\n\nvar wrapIn$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  wrapIn: wrapIn\n});\n\nvar wrapInList = function wrapInList(typeOrName) {\n  var attributes = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return function (_ref61) {\n    var state = _ref61.state,\n        dispatch = _ref61.dispatch;\n    var type = getNodeType(typeOrName, state.schema);\n    return wrapInList$2(type, attributes)(state, dispatch);\n  };\n};\n\nvar wrapInList$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  wrapInList: wrapInList\n});\nvar Commands = Extension.create({\n  name: 'commands',\n  addCommands: function addCommands() {\n    return _objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread({}, blur$1), clearContent$1), clearNodes$1), command$1), createParagraphNear$1), deleteNode$1), deleteRange$1), deleteSelection$1), enter$1), exitCode$1), extendMarkRange$1), first$1), focus$1), forEach$1), insertContent$1), insertContentAt$1), joinBackward$1), joinForward$1), keyboardShortcut$1), lift$1), liftEmptyBlock$1), liftListItem$1), newlineInCode$1), resetAttributes$1), scrollIntoView$1), selectAll$1), selectNodeBackward$1), selectNodeForward$1), selectParentNode$1), selectTextblockEnd$1), selectTextblockStart$1), setContent$1), setMark$1), setMeta$1), setNode$1), setNodeSelection$1), setTextSelection$1), sinkListItem$1), splitBlock$1), splitListItem$1), toggleList$1), toggleMark$1), toggleNode$1), toggleWrap$1), undoInputRule$1), unsetAllMarks$1), unsetMark$1), updateAttributes$1), wrapIn$1), wrapInList$1);\n  }\n});\nvar Editable = Extension.create({\n  name: 'editable',\n  addProseMirrorPlugins: function addProseMirrorPlugins() {\n    var _this2 = this;\n\n    return [new Plugin({\n      key: new PluginKey('editable'),\n      props: {\n        editable: function editable() {\n          return _this2.editor.options.editable;\n        }\n      }\n    })];\n  }\n});\nvar FocusEvents = Extension.create({\n  name: 'focusEvents',\n  addProseMirrorPlugins: function addProseMirrorPlugins() {\n    var editor = this.editor;\n    return [new Plugin({\n      key: new PluginKey('focusEvents'),\n      props: {\n        handleDOMEvents: {\n          focus: function focus(view, event) {\n            editor.isFocused = true;\n            var transaction = editor.state.tr.setMeta('focus', {\n              event: event\n            }).setMeta('addToHistory', false);\n            view.dispatch(transaction);\n            return false;\n          },\n          blur: function blur(view, event) {\n            editor.isFocused = false;\n            var transaction = editor.state.tr.setMeta('blur', {\n              event: event\n            }).setMeta('addToHistory', false);\n            view.dispatch(transaction);\n            return false;\n          }\n        }\n      }\n    })];\n  }\n});\n\nfunction createChainableState(config) {\n  var state = config.state,\n      transaction = config.transaction;\n  var selection = transaction.selection;\n  var doc = transaction.doc;\n  var storedMarks = transaction.storedMarks;\n  return _objectSpread(_objectSpread({}, state), {}, {\n    schema: state.schema,\n    plugins: state.plugins,\n    apply: state.apply.bind(state),\n    applyTransaction: state.applyTransaction.bind(state),\n    reconfigure: state.reconfigure.bind(state),\n    toJSON: state.toJSON.bind(state),\n\n    get storedMarks() {\n      return storedMarks;\n    },\n\n    get selection() {\n      return selection;\n    },\n\n    get doc() {\n      return doc;\n    },\n\n    get tr() {\n      selection = transaction.selection;\n      doc = transaction.doc;\n      storedMarks = transaction.storedMarks;\n      return transaction;\n    }\n\n  });\n}\n\nvar CommandManager = /*#__PURE__*/function () {\n  function CommandManager(props) {\n    _classCallCheck(this, CommandManager);\n\n    this.editor = props.editor;\n    this.rawCommands = this.editor.extensionManager.commands;\n    this.customState = props.state;\n  }\n\n  _createClass(CommandManager, [{\n    key: \"hasCustomState\",\n    get: function get() {\n      return !!this.customState;\n    }\n  }, {\n    key: \"state\",\n    get: function get() {\n      return this.customState || this.editor.state;\n    }\n  }, {\n    key: \"commands\",\n    get: function get() {\n      var _this3 = this;\n\n      var rawCommands = this.rawCommands,\n          editor = this.editor,\n          state = this.state;\n      var view = editor.view;\n      var tr = state.tr;\n      var props = this.buildProps(tr);\n      return Object.fromEntries(Object.entries(rawCommands).map(function (_ref62) {\n        var _ref63 = _slicedToArray(_ref62, 2),\n            name = _ref63[0],\n            command = _ref63[1];\n\n        var method = function method() {\n          var callback = command.apply(void 0, arguments)(props);\n\n          if (!tr.getMeta('preventDispatch') && !_this3.hasCustomState) {\n            view.dispatch(tr);\n          }\n\n          return callback;\n        };\n\n        return [name, method];\n      }));\n    }\n  }, {\n    key: \"chain\",\n    get: function get() {\n      var _this4 = this;\n\n      return function () {\n        return _this4.createChain();\n      };\n    }\n  }, {\n    key: \"can\",\n    get: function get() {\n      var _this5 = this;\n\n      return function () {\n        return _this5.createCan();\n      };\n    }\n  }, {\n    key: \"createChain\",\n    value: function createChain(startTr) {\n      var _this6 = this;\n\n      var shouldDispatch = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n      var rawCommands = this.rawCommands,\n          editor = this.editor,\n          state = this.state;\n      var view = editor.view;\n      var callbacks = [];\n      var hasStartTransaction = !!startTr;\n      var tr = startTr || state.tr;\n\n      var run = function run() {\n        if (!hasStartTransaction && shouldDispatch && !tr.getMeta('preventDispatch') && !_this6.hasCustomState) {\n          view.dispatch(tr);\n        }\n\n        return callbacks.every(function (callback) {\n          return callback === true;\n        });\n      };\n\n      var chain = _objectSpread(_objectSpread({}, Object.fromEntries(Object.entries(rawCommands).map(function (_ref64) {\n        var _ref65 = _slicedToArray(_ref64, 2),\n            name = _ref65[0],\n            command = _ref65[1];\n\n        var chainedCommand = function chainedCommand() {\n          var props = _this6.buildProps(tr, shouldDispatch);\n\n          var callback = command.apply(void 0, arguments)(props);\n          callbacks.push(callback);\n          return chain;\n        };\n\n        return [name, chainedCommand];\n      }))), {}, {\n        run: run\n      });\n\n      return chain;\n    }\n  }, {\n    key: \"createCan\",\n    value: function createCan(startTr) {\n      var _this7 = this;\n\n      var rawCommands = this.rawCommands,\n          state = this.state;\n      var dispatch = undefined;\n      var tr = startTr || state.tr;\n      var props = this.buildProps(tr, dispatch);\n      var formattedCommands = Object.fromEntries(Object.entries(rawCommands).map(function (_ref66) {\n        var _ref67 = _slicedToArray(_ref66, 2),\n            name = _ref67[0],\n            command = _ref67[1];\n\n        return [name, function () {\n          return command.apply(void 0, arguments)(_objectSpread(_objectSpread({}, props), {}, {\n            dispatch: dispatch\n          }));\n        }];\n      }));\n      return _objectSpread(_objectSpread({}, formattedCommands), {}, {\n        chain: function chain() {\n          return _this7.createChain(tr, dispatch);\n        }\n      });\n    }\n  }, {\n    key: \"buildProps\",\n    value: function buildProps(tr) {\n      var _this8 = this;\n\n      var shouldDispatch = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n      var rawCommands = this.rawCommands,\n          editor = this.editor,\n          state = this.state;\n      var view = editor.view;\n\n      if (state.storedMarks) {\n        tr.setStoredMarks(state.storedMarks);\n      }\n\n      var props = {\n        tr: tr,\n        editor: editor,\n        view: view,\n        state: createChainableState({\n          state: state,\n          transaction: tr\n        }),\n        dispatch: shouldDispatch ? function () {\n          return undefined;\n        } : undefined,\n        chain: function chain() {\n          return _this8.createChain(tr);\n        },\n        can: function can() {\n          return _this8.createCan(tr);\n        },\n\n        get commands() {\n          return Object.fromEntries(Object.entries(rawCommands).map(function (_ref68) {\n            var _ref69 = _slicedToArray(_ref68, 2),\n                name = _ref69[0],\n                command = _ref69[1];\n\n            return [name, function () {\n              return command.apply(void 0, arguments)(props);\n            }];\n          }));\n        }\n\n      };\n      return props;\n    }\n  }]);\n\n  return CommandManager;\n}();\n\nvar Keymap = Extension.create({\n  name: 'keymap',\n  addKeyboardShortcuts: function addKeyboardShortcuts() {\n    var _this9 = this;\n\n    var handleBackspace = function handleBackspace() {\n      return _this9.editor.commands.first(function (_ref70) {\n        var commands = _ref70.commands;\n        return [function () {\n          return commands.undoInputRule();\n        }, // maybe convert first text block node to default node\n        function () {\n          return commands.command(function (_ref71) {\n            var tr = _ref71.tr;\n            var selection = tr.selection,\n                doc = tr.doc;\n            var empty = selection.empty,\n                $anchor = selection.$anchor;\n            var pos = $anchor.pos,\n                parent = $anchor.parent;\n            var isAtStart = Selection.atStart(doc).from === pos;\n\n            if (!empty || !isAtStart || !parent.type.isTextblock || parent.textContent.length) {\n              return false;\n            }\n\n            return commands.clearNodes();\n          });\n        }, function () {\n          return commands.deleteSelection();\n        }, function () {\n          return commands.joinBackward();\n        }, function () {\n          return commands.selectNodeBackward();\n        }];\n      });\n    };\n\n    var handleDelete = function handleDelete() {\n      return _this9.editor.commands.first(function (_ref72) {\n        var commands = _ref72.commands;\n        return [function () {\n          return commands.deleteSelection();\n        }, function () {\n          return commands.joinForward();\n        }, function () {\n          return commands.selectNodeForward();\n        }];\n      });\n    };\n\n    var handleEnter = function handleEnter() {\n      return _this9.editor.commands.first(function (_ref73) {\n        var commands = _ref73.commands;\n        return [function () {\n          return commands.newlineInCode();\n        }, function () {\n          return commands.createParagraphNear();\n        }, function () {\n          return commands.liftEmptyBlock();\n        }, function () {\n          return commands.splitBlock();\n        }];\n      });\n    };\n\n    var baseKeymap = {\n      Enter: handleEnter,\n      'Mod-Enter': function ModEnter() {\n        return _this9.editor.commands.exitCode();\n      },\n      Backspace: handleBackspace,\n      'Mod-Backspace': handleBackspace,\n      'Shift-Backspace': handleBackspace,\n      Delete: handleDelete,\n      'Mod-Delete': handleDelete,\n      'Mod-a': function ModA() {\n        return _this9.editor.commands.selectAll();\n      }\n    };\n\n    var pcKeymap = _objectSpread(_objectSpread({}, baseKeymap), {}, {\n      Home: function Home() {\n        return _this9.editor.commands.selectTextblockStart();\n      },\n      End: function End() {\n        return _this9.editor.commands.selectTextblockEnd();\n      }\n    });\n\n    var macKeymap = _objectSpread(_objectSpread({}, baseKeymap), {}, {\n      'Ctrl-h': handleBackspace,\n      'Alt-Backspace': handleBackspace,\n      'Ctrl-d': handleDelete,\n      'Ctrl-Alt-Backspace': handleDelete,\n      'Alt-Delete': handleDelete,\n      'Alt-d': handleDelete,\n      'Ctrl-a': function CtrlA() {\n        return _this9.editor.commands.selectTextblockStart();\n      },\n      'Ctrl-e': function CtrlE() {\n        return _this9.editor.commands.selectTextblockEnd();\n      }\n    });\n\n    if (isiOS() || isMacOS()) {\n      return macKeymap;\n    }\n\n    return pcKeymap;\n  },\n  addProseMirrorPlugins: function addProseMirrorPlugins() {\n    var _this10 = this;\n\n    return [// With this plugin we check if the whole document was selected and deleted.\n    // In this case we will additionally call `clearNodes()` to convert e.g. a heading\n    // to a paragraph if necessary.\n    // This is an alternative to ProseMirror's `AllSelection`, which doesnt work well\n    // with many other commands.\n    new Plugin({\n      key: new PluginKey('clearDocument'),\n      appendTransaction: function appendTransaction(transactions, oldState, newState) {\n        var docChanges = transactions.some(function (transaction) {\n          return transaction.docChanged;\n        }) && !oldState.doc.eq(newState.doc);\n\n        if (!docChanges) {\n          return;\n        }\n\n        var _oldState$selection = oldState.selection,\n            empty = _oldState$selection.empty,\n            from = _oldState$selection.from,\n            to = _oldState$selection.to;\n        var allFrom = Selection.atStart(oldState.doc).from;\n        var allEnd = Selection.atEnd(oldState.doc).to;\n        var allWasSelected = from === allFrom && to === allEnd;\n        var isEmpty = newState.doc.textBetween(0, newState.doc.content.size, ' ', ' ').length === 0;\n\n        if (empty || !allWasSelected || !isEmpty) {\n          return;\n        }\n\n        var tr = newState.tr;\n        var state = createChainableState({\n          state: newState,\n          transaction: tr\n        });\n\n        var _CommandManager = new CommandManager({\n          editor: _this10.editor,\n          state: state\n        }),\n            commands = _CommandManager.commands;\n\n        commands.clearNodes();\n\n        if (!tr.steps.length) {\n          return;\n        }\n\n        return tr;\n      }\n    })];\n  }\n});\nvar Tabindex = Extension.create({\n  name: 'tabindex',\n  addProseMirrorPlugins: function addProseMirrorPlugins() {\n    var _this11 = this;\n\n    return [new Plugin({\n      key: new PluginKey('tabindex'),\n      props: {\n        attributes: function attributes() {\n          if (_this11.editor.isEditable) {\n            return {\n              tabindex: '0'\n            };\n          }\n        }\n      }\n    })];\n  }\n});\nvar extensions = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  ClipboardTextSerializer: ClipboardTextSerializer,\n  Commands: Commands,\n  Editable: Editable,\n  FocusEvents: FocusEvents,\n  Keymap: Keymap,\n  Tabindex: Tabindex\n});\n\nfunction getNodeAttributes(state, typeOrName) {\n  var type = getNodeType(typeOrName, state.schema);\n  var _state$selection5 = state.selection,\n      from = _state$selection5.from,\n      to = _state$selection5.to;\n  var nodes = [];\n  state.doc.nodesBetween(from, to, function (node) {\n    nodes.push(node);\n  });\n  var node = nodes.reverse().find(function (nodeItem) {\n    return nodeItem.type.name === type.name;\n  });\n\n  if (!node) {\n    return {};\n  }\n\n  return _objectSpread({}, node.attrs);\n}\n\nfunction _getAttributes(state, typeOrName) {\n  var schemaType = getSchemaTypeNameByName(typeof typeOrName === 'string' ? typeOrName : typeOrName.name, state.schema);\n\n  if (schemaType === 'node') {\n    return getNodeAttributes(state, typeOrName);\n  }\n\n  if (schemaType === 'mark') {\n    return getMarkAttributes(state, typeOrName);\n  }\n\n  return {};\n}\n\nfunction _isActive(state, name) {\n  var attributes = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  if (!name) {\n    return isNodeActive(state, null, attributes) || isMarkActive(state, null, attributes);\n  }\n\n  var schemaType = getSchemaTypeNameByName(name, state.schema);\n\n  if (schemaType === 'node') {\n    return isNodeActive(state, name, attributes);\n  }\n\n  if (schemaType === 'mark') {\n    return isMarkActive(state, name, attributes);\n  }\n\n  return false;\n}\n\nfunction getHTMLFromFragment(fragment, schema) {\n  var documentFragment = DOMSerializer.fromSchema(schema).serializeFragment(fragment);\n  var temporaryDocument = document.implementation.createHTMLDocument();\n  var container = temporaryDocument.createElement('div');\n  container.appendChild(documentFragment);\n  return container.innerHTML;\n}\n\nfunction _getText(node, options) {\n  var range = {\n    from: 0,\n    to: node.content.size\n  };\n  return getTextBetween(node, range, options);\n}\n\nfunction isNodeEmpty(node) {\n  var _a;\n\n  var defaultContent = (_a = node.type.createAndFill()) === null || _a === void 0 ? void 0 : _a.toJSON();\n  var content = node.toJSON();\n  return JSON.stringify(defaultContent) === JSON.stringify(content);\n}\n\nfunction createStyleTag(style) {\n  var tipTapStyleTag = document.querySelector('style[data-tiptap-style]');\n\n  if (tipTapStyleTag !== null) {\n    return tipTapStyleTag;\n  }\n\n  var styleNode = document.createElement('style');\n  styleNode.setAttribute('data-tiptap-style', '');\n  styleNode.innerHTML = style;\n  document.getElementsByTagName('head')[0].appendChild(styleNode);\n  return styleNode;\n}\n\nvar InputRule = /*#__PURE__*/_createClass(function InputRule(config) {\n  _classCallCheck(this, InputRule);\n\n  this.find = config.find;\n  this.handler = config.handler;\n});\n\nvar inputRuleMatcherHandler = function inputRuleMatcherHandler(text, find) {\n  if (isRegExp(find)) {\n    return find.exec(text);\n  }\n\n  var inputRuleMatch = find(text);\n\n  if (!inputRuleMatch) {\n    return null;\n  }\n\n  var result = [];\n  result.push(inputRuleMatch.text);\n  result.index = inputRuleMatch.index;\n  result.input = text;\n  result.data = inputRuleMatch.data;\n\n  if (inputRuleMatch.replaceWith) {\n    if (!inputRuleMatch.text.includes(inputRuleMatch.replaceWith)) {\n      console.warn('[tiptap warn]: \"inputRuleMatch.replaceWith\" must be part of \"inputRuleMatch.text\".');\n    }\n\n    result.push(inputRuleMatch.replaceWith);\n  }\n\n  return result;\n};\n\nfunction run$1(config) {\n  var _a;\n\n  var editor = config.editor,\n      from = config.from,\n      to = config.to,\n      text = config.text,\n      rules = config.rules,\n      plugin = config.plugin;\n  var view = editor.view;\n\n  if (view.composing) {\n    return false;\n  }\n\n  var $from = view.state.doc.resolve(from);\n\n  if ( // check for code node\n  $from.parent.type.spec.code // check for code mark\n  || !!((_a = $from.nodeBefore || $from.nodeAfter) === null || _a === void 0 ? void 0 : _a.marks.find(function (mark) {\n    return mark.type.spec.code;\n  }))) {\n    return false;\n  }\n\n  var matched = false;\n  var maxMatch = 500;\n  var textBefore = $from.parent.textBetween(Math.max(0, $from.parentOffset - maxMatch), $from.parentOffset, undefined, ' ') + text;\n  rules.forEach(function (rule) {\n    if (matched) {\n      return;\n    }\n\n    var match = inputRuleMatcherHandler(textBefore, rule.find);\n\n    if (!match) {\n      return;\n    }\n\n    var tr = view.state.tr;\n    var state = createChainableState({\n      state: view.state,\n      transaction: tr\n    });\n    var range = {\n      from: from - (match[0].length - text.length),\n      to: to\n    };\n\n    var _CommandManager2 = new CommandManager({\n      editor: editor,\n      state: state\n    }),\n        commands = _CommandManager2.commands,\n        chain = _CommandManager2.chain,\n        can = _CommandManager2.can;\n\n    var handler = rule.handler({\n      state: state,\n      range: range,\n      match: match,\n      commands: commands,\n      chain: chain,\n      can: can\n    }); // stop if there are no changes\n\n    if (handler === null || !tr.steps.length) {\n      return;\n    } // store transform as meta data\n    // so we can undo input rules within the `undoInputRules` command\n\n\n    tr.setMeta(plugin, {\n      transform: tr,\n      from: from,\n      to: to,\n      text: text\n    });\n    view.dispatch(tr);\n    matched = true;\n  });\n  return matched;\n}\n/**\r\n * Create an input rules plugin. When enabled, it will cause text\r\n * input that matches any of the given rules to trigger the rules\r\n * action.\r\n */\n\n\nfunction inputRulesPlugin(props) {\n  var editor = props.editor,\n      rules = props.rules;\n  var plugin = new Plugin({\n    state: {\n      init: function init() {\n        return null;\n      },\n      apply: function apply(tr, prev) {\n        var stored = tr.getMeta(this);\n\n        if (stored) {\n          return stored;\n        }\n\n        return tr.selectionSet || tr.docChanged ? null : prev;\n      }\n    },\n    props: {\n      handleTextInput: function handleTextInput(view, from, to, text) {\n        return run$1({\n          editor: editor,\n          from: from,\n          to: to,\n          text: text,\n          rules: rules,\n          plugin: plugin\n        });\n      },\n      handleDOMEvents: {\n        compositionend: function compositionend(view) {\n          setTimeout(function () {\n            var $cursor = view.state.selection.$cursor;\n\n            if ($cursor) {\n              run$1({\n                editor: editor,\n                from: $cursor.pos,\n                to: $cursor.pos,\n                text: '',\n                rules: rules,\n                plugin: plugin\n              });\n            }\n          });\n          return false;\n        }\n      },\n      // add support for input rules to trigger on enter\n      // this is useful for example for code blocks\n      handleKeyDown: function handleKeyDown(view, event) {\n        if (event.key !== 'Enter') {\n          return false;\n        }\n\n        var $cursor = view.state.selection.$cursor;\n\n        if ($cursor) {\n          return run$1({\n            editor: editor,\n            from: $cursor.pos,\n            to: $cursor.pos,\n            text: '\\n',\n            rules: rules,\n            plugin: plugin\n          });\n        }\n\n        return false;\n      }\n    },\n    // @ts-ignore\n    isInputRules: true\n  });\n  return plugin;\n}\n\nfunction isNumber(value) {\n  return typeof value === 'number';\n}\n\nvar PasteRule = /*#__PURE__*/_createClass(function PasteRule(config) {\n  _classCallCheck(this, PasteRule);\n\n  this.find = config.find;\n  this.handler = config.handler;\n});\n\nvar pasteRuleMatcherHandler = function pasteRuleMatcherHandler(text, find) {\n  if (isRegExp(find)) {\n    return _toConsumableArray(text.matchAll(find));\n  }\n\n  var matches = find(text);\n\n  if (!matches) {\n    return [];\n  }\n\n  return matches.map(function (pasteRuleMatch) {\n    var result = [];\n    result.push(pasteRuleMatch.text);\n    result.index = pasteRuleMatch.index;\n    result.input = text;\n    result.data = pasteRuleMatch.data;\n\n    if (pasteRuleMatch.replaceWith) {\n      if (!pasteRuleMatch.text.includes(pasteRuleMatch.replaceWith)) {\n        console.warn('[tiptap warn]: \"pasteRuleMatch.replaceWith\" must be part of \"pasteRuleMatch.text\".');\n      }\n\n      result.push(pasteRuleMatch.replaceWith);\n    }\n\n    return result;\n  });\n};\n\nfunction run(config) {\n  var editor = config.editor,\n      state = config.state,\n      from = config.from,\n      to = config.to,\n      rule = config.rule;\n\n  var _CommandManager3 = new CommandManager({\n    editor: editor,\n    state: state\n  }),\n      commands = _CommandManager3.commands,\n      chain = _CommandManager3.chain,\n      can = _CommandManager3.can;\n\n  var handlers = [];\n  state.doc.nodesBetween(from, to, function (node, pos) {\n    if (!node.isTextblock || node.type.spec.code) {\n      return;\n    }\n\n    var resolvedFrom = Math.max(from, pos);\n    var resolvedTo = Math.min(to, pos + node.content.size);\n    var textToMatch = node.textBetween(resolvedFrom - pos, resolvedTo - pos, undefined, \"\\uFFFC\");\n    var matches = pasteRuleMatcherHandler(textToMatch, rule.find);\n    matches.forEach(function (match) {\n      if (match.index === undefined) {\n        return;\n      }\n\n      var start = resolvedFrom + match.index + 1;\n      var end = start + match[0].length;\n      var range = {\n        from: state.tr.mapping.map(start),\n        to: state.tr.mapping.map(end)\n      };\n      var handler = rule.handler({\n        state: state,\n        range: range,\n        match: match,\n        commands: commands,\n        chain: chain,\n        can: can\n      });\n      handlers.push(handler);\n    });\n  });\n  var success = handlers.every(function (handler) {\n    return handler !== null;\n  });\n  return success;\n}\n/**\r\n * Create an paste rules plugin. When enabled, it will cause pasted\r\n * text that matches any of the given rules to trigger the rules\r\n * action.\r\n */\n\n\nfunction pasteRulesPlugin(props) {\n  var editor = props.editor,\n      rules = props.rules;\n  var dragSourceElement = null;\n  var isPastedFromProseMirror = false;\n  var isDroppedFromProseMirror = false;\n  var plugins = rules.map(function (rule) {\n    return new Plugin({\n      // we register a global drag handler to track the current drag source element\n      view: function view(_view) {\n        var handleDragstart = function handleDragstart(event) {\n          var _a;\n\n          dragSourceElement = ((_a = _view.dom.parentElement) === null || _a === void 0 ? void 0 : _a.contains(event.target)) ? _view.dom.parentElement : null;\n        };\n\n        window.addEventListener('dragstart', handleDragstart);\n        return {\n          destroy: function destroy() {\n            window.removeEventListener('dragstart', handleDragstart);\n          }\n        };\n      },\n      props: {\n        handleDOMEvents: {\n          drop: function drop(view) {\n            isDroppedFromProseMirror = dragSourceElement === view.dom.parentElement;\n            return false;\n          },\n          paste: function paste(view, event) {\n            var _a;\n\n            var html = (_a = event.clipboardData) === null || _a === void 0 ? void 0 : _a.getData('text/html');\n            isPastedFromProseMirror = !!(html === null || html === void 0 ? void 0 : html.includes('data-pm-slice'));\n            return false;\n          }\n        }\n      },\n      appendTransaction: function appendTransaction(transactions, oldState, state) {\n        var transaction = transactions[0];\n        var isPaste = transaction.getMeta('uiEvent') === 'paste' && !isPastedFromProseMirror;\n        var isDrop = transaction.getMeta('uiEvent') === 'drop' && !isDroppedFromProseMirror;\n\n        if (!isPaste && !isDrop) {\n          return;\n        } // stop if there is no changed range\n\n\n        var from = oldState.doc.content.findDiffStart(state.doc.content);\n        var to = oldState.doc.content.findDiffEnd(state.doc.content);\n\n        if (!isNumber(from) || !to || from === to.b) {\n          return;\n        } // build a chainable state\n        // so we can use a single transaction for all paste rules\n\n\n        var tr = state.tr;\n        var chainableState = createChainableState({\n          state: state,\n          transaction: tr\n        });\n        var handler = run({\n          editor: editor,\n          state: chainableState,\n          from: Math.max(from - 1, 0),\n          to: to.b,\n          rule: rule\n        }); // stop if there are no changes\n\n        if (!handler || !tr.steps.length) {\n          return;\n        }\n\n        return tr;\n      }\n    });\n  });\n  return plugins;\n}\n/**\r\n * Get a list of all extension attributes defined in `addAttribute` and `addGlobalAttribute`.\r\n * @param extensions List of extensions\r\n */\n\n\nfunction getAttributesFromExtensions(extensions) {\n  var extensionAttributes = [];\n\n  var _splitExtensions2 = splitExtensions(extensions),\n      nodeExtensions = _splitExtensions2.nodeExtensions,\n      markExtensions = _splitExtensions2.markExtensions;\n\n  var nodeAndMarkExtensions = [].concat(_toConsumableArray(nodeExtensions), _toConsumableArray(markExtensions));\n  var defaultAttribute = {\n    default: null,\n    rendered: true,\n    renderHTML: null,\n    parseHTML: null,\n    keepOnSplit: true\n  };\n  extensions.forEach(function (extension) {\n    var context = {\n      name: extension.name,\n      options: extension.options,\n      storage: extension.storage\n    };\n    var addGlobalAttributes = getExtensionField(extension, 'addGlobalAttributes', context);\n\n    if (!addGlobalAttributes) {\n      return;\n    } // TODO: remove `as GlobalAttributes`\n\n\n    var globalAttributes = addGlobalAttributes();\n    globalAttributes.forEach(function (globalAttribute) {\n      globalAttribute.types.forEach(function (type) {\n        Object.entries(globalAttribute.attributes).forEach(function (_ref74) {\n          var _ref75 = _slicedToArray(_ref74, 2),\n              name = _ref75[0],\n              attribute = _ref75[1];\n\n          extensionAttributes.push({\n            type: type,\n            name: name,\n            attribute: _objectSpread(_objectSpread({}, defaultAttribute), attribute)\n          });\n        });\n      });\n    });\n  });\n  nodeAndMarkExtensions.forEach(function (extension) {\n    var context = {\n      name: extension.name,\n      options: extension.options,\n      storage: extension.storage\n    };\n    var addAttributes = getExtensionField(extension, 'addAttributes', context);\n\n    if (!addAttributes) {\n      return;\n    } // TODO: remove `as Attributes`\n\n\n    var attributes = addAttributes();\n    Object.entries(attributes).forEach(function (_ref76) {\n      var _ref77 = _slicedToArray(_ref76, 2),\n          name = _ref77[0],\n          attribute = _ref77[1];\n\n      extensionAttributes.push({\n        type: extension.name,\n        name: name,\n        attribute: _objectSpread(_objectSpread({}, defaultAttribute), attribute)\n      });\n    });\n  });\n  return extensionAttributes;\n}\n\nfunction mergeAttributes() {\n  for (var _len2 = arguments.length, objects = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n    objects[_key2] = arguments[_key2];\n  }\n\n  return objects.filter(function (item) {\n    return !!item;\n  }).reduce(function (items, item) {\n    var mergedAttributes = _objectSpread({}, items);\n\n    Object.entries(item).forEach(function (_ref78) {\n      var _ref79 = _slicedToArray(_ref78, 2),\n          key = _ref79[0],\n          value = _ref79[1];\n\n      var exists = mergedAttributes[key];\n\n      if (!exists) {\n        mergedAttributes[key] = value;\n        return;\n      }\n\n      if (key === 'class') {\n        mergedAttributes[key] = [mergedAttributes[key], value].join(' ');\n      } else if (key === 'style') {\n        mergedAttributes[key] = [mergedAttributes[key], value].join('; ');\n      } else {\n        mergedAttributes[key] = value;\n      }\n    });\n    return mergedAttributes;\n  }, {});\n}\n\nfunction getRenderedAttributes(nodeOrMark, extensionAttributes) {\n  return extensionAttributes.filter(function (item) {\n    return item.attribute.rendered;\n  }).map(function (item) {\n    if (!item.attribute.renderHTML) {\n      return _defineProperty({}, item.name, nodeOrMark.attrs[item.name]);\n    }\n\n    return item.attribute.renderHTML(nodeOrMark.attrs) || {};\n  }).reduce(function (attributes, attribute) {\n    return mergeAttributes(attributes, attribute);\n  }, {});\n}\n\nfunction isEmptyObject() {\n  var value = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  return Object.keys(value).length === 0 && value.constructor === Object;\n}\n\nfunction fromString(value) {\n  if (typeof value !== 'string') {\n    return value;\n  }\n\n  if (value.match(/^[+-]?(?:\\d*\\.)?\\d+$/)) {\n    return Number(value);\n  }\n\n  if (value === 'true') {\n    return true;\n  }\n\n  if (value === 'false') {\n    return false;\n  }\n\n  return value;\n}\n/**\r\n * This function merges extension attributes into parserule attributes (`attrs` or `getAttrs`).\r\n * Cancels when `getAttrs` returned `false`.\r\n * @param parseRule ProseMirror ParseRule\r\n * @param extensionAttributes List of attributes to inject\r\n */\n\n\nfunction injectExtensionAttributesToParseRule(parseRule, extensionAttributes) {\n  if (parseRule.style) {\n    return parseRule;\n  }\n\n  return _objectSpread(_objectSpread({}, parseRule), {}, {\n    getAttrs: function getAttrs(node) {\n      var oldAttributes = parseRule.getAttrs ? parseRule.getAttrs(node) : parseRule.attrs;\n\n      if (oldAttributes === false) {\n        return false;\n      }\n\n      var newAttributes = extensionAttributes.reduce(function (items, item) {\n        var value = item.attribute.parseHTML ? item.attribute.parseHTML(node) : fromString(node.getAttribute(item.name));\n\n        if (value === null || value === undefined) {\n          return items;\n        }\n\n        return _objectSpread(_objectSpread({}, items), {}, _defineProperty({}, item.name, value));\n      }, {});\n      return _objectSpread(_objectSpread({}, oldAttributes), newAttributes);\n    }\n  });\n}\n\nfunction cleanUpSchemaItem(data) {\n  return Object.fromEntries(Object.entries(data).filter(function (_ref81) {\n    var _ref82 = _slicedToArray(_ref81, 2),\n        key = _ref82[0],\n        value = _ref82[1];\n\n    if (key === 'attrs' && isEmptyObject(value)) {\n      return false;\n    }\n\n    return value !== null && value !== undefined;\n  }));\n}\n\nfunction getSchemaByResolvedExtensions(extensions) {\n  var _a;\n\n  var allAttributes = getAttributesFromExtensions(extensions);\n\n  var _splitExtensions3 = splitExtensions(extensions),\n      nodeExtensions = _splitExtensions3.nodeExtensions,\n      markExtensions = _splitExtensions3.markExtensions;\n\n  var topNode = (_a = nodeExtensions.find(function (extension) {\n    return getExtensionField(extension, 'topNode');\n  })) === null || _a === void 0 ? void 0 : _a.name;\n  var nodes = Object.fromEntries(nodeExtensions.map(function (extension) {\n    var extensionAttributes = allAttributes.filter(function (attribute) {\n      return attribute.type === extension.name;\n    });\n    var context = {\n      name: extension.name,\n      options: extension.options,\n      storage: extension.storage\n    };\n    var extraNodeFields = extensions.reduce(function (fields, e) {\n      var extendNodeSchema = getExtensionField(e, 'extendNodeSchema', context);\n      return _objectSpread(_objectSpread({}, fields), extendNodeSchema ? extendNodeSchema(extension) : {});\n    }, {});\n    var schema = cleanUpSchemaItem(_objectSpread(_objectSpread({}, extraNodeFields), {}, {\n      content: callOrReturn(getExtensionField(extension, 'content', context)),\n      marks: callOrReturn(getExtensionField(extension, 'marks', context)),\n      group: callOrReturn(getExtensionField(extension, 'group', context)),\n      inline: callOrReturn(getExtensionField(extension, 'inline', context)),\n      atom: callOrReturn(getExtensionField(extension, 'atom', context)),\n      selectable: callOrReturn(getExtensionField(extension, 'selectable', context)),\n      draggable: callOrReturn(getExtensionField(extension, 'draggable', context)),\n      code: callOrReturn(getExtensionField(extension, 'code', context)),\n      defining: callOrReturn(getExtensionField(extension, 'defining', context)),\n      isolating: callOrReturn(getExtensionField(extension, 'isolating', context)),\n      attrs: Object.fromEntries(extensionAttributes.map(function (extensionAttribute) {\n        var _a;\n\n        return [extensionAttribute.name, {\n          default: (_a = extensionAttribute === null || extensionAttribute === void 0 ? void 0 : extensionAttribute.attribute) === null || _a === void 0 ? void 0 : _a.default\n        }];\n      }))\n    }));\n    var parseHTML = callOrReturn(getExtensionField(extension, 'parseHTML', context));\n\n    if (parseHTML) {\n      schema.parseDOM = parseHTML.map(function (parseRule) {\n        return injectExtensionAttributesToParseRule(parseRule, extensionAttributes);\n      });\n    }\n\n    var renderHTML = getExtensionField(extension, 'renderHTML', context);\n\n    if (renderHTML) {\n      schema.toDOM = function (node) {\n        return renderHTML({\n          node: node,\n          HTMLAttributes: getRenderedAttributes(node, extensionAttributes)\n        });\n      };\n    }\n\n    var renderText = getExtensionField(extension, 'renderText', context);\n\n    if (renderText) {\n      schema.toText = renderText;\n    }\n\n    return [extension.name, schema];\n  }));\n  var marks = Object.fromEntries(markExtensions.map(function (extension) {\n    var extensionAttributes = allAttributes.filter(function (attribute) {\n      return attribute.type === extension.name;\n    });\n    var context = {\n      name: extension.name,\n      options: extension.options,\n      storage: extension.storage\n    };\n    var extraMarkFields = extensions.reduce(function (fields, e) {\n      var extendMarkSchema = getExtensionField(e, 'extendMarkSchema', context);\n      return _objectSpread(_objectSpread({}, fields), extendMarkSchema ? extendMarkSchema(extension) : {});\n    }, {});\n    var schema = cleanUpSchemaItem(_objectSpread(_objectSpread({}, extraMarkFields), {}, {\n      inclusive: callOrReturn(getExtensionField(extension, 'inclusive', context)),\n      excludes: callOrReturn(getExtensionField(extension, 'excludes', context)),\n      group: callOrReturn(getExtensionField(extension, 'group', context)),\n      spanning: callOrReturn(getExtensionField(extension, 'spanning', context)),\n      code: callOrReturn(getExtensionField(extension, 'code', context)),\n      attrs: Object.fromEntries(extensionAttributes.map(function (extensionAttribute) {\n        var _a;\n\n        return [extensionAttribute.name, {\n          default: (_a = extensionAttribute === null || extensionAttribute === void 0 ? void 0 : extensionAttribute.attribute) === null || _a === void 0 ? void 0 : _a.default\n        }];\n      }))\n    }));\n    var parseHTML = callOrReturn(getExtensionField(extension, 'parseHTML', context));\n\n    if (parseHTML) {\n      schema.parseDOM = parseHTML.map(function (parseRule) {\n        return injectExtensionAttributesToParseRule(parseRule, extensionAttributes);\n      });\n    }\n\n    var renderHTML = getExtensionField(extension, 'renderHTML', context);\n\n    if (renderHTML) {\n      schema.toDOM = function (mark) {\n        return renderHTML({\n          mark: mark,\n          HTMLAttributes: getRenderedAttributes(mark, extensionAttributes)\n        });\n      };\n    }\n\n    return [extension.name, schema];\n  }));\n  return new Schema({\n    topNode: topNode,\n    nodes: nodes,\n    marks: marks\n  });\n}\n\nfunction getSchemaTypeByName(name, schema) {\n  return schema.nodes[name] || schema.marks[name] || null;\n}\n\nfunction isExtensionRulesEnabled(extension, enabled) {\n  if (Array.isArray(enabled)) {\n    return enabled.some(function (enabledExtension) {\n      var name = typeof enabledExtension === 'string' ? enabledExtension : enabledExtension.name;\n      return name === extension.name;\n    });\n  }\n\n  return enabled;\n}\n\nfunction findDuplicates(items) {\n  var filtered = items.filter(function (el, index) {\n    return items.indexOf(el) !== index;\n  });\n  return _toConsumableArray(new Set(filtered));\n}\n\nvar ExtensionManager = /*#__PURE__*/function () {\n  function ExtensionManager(extensions, editor) {\n    var _this12 = this;\n\n    _classCallCheck(this, ExtensionManager);\n\n    this.splittableMarks = [];\n    this.editor = editor;\n    this.extensions = ExtensionManager.resolve(extensions);\n    this.schema = getSchemaByResolvedExtensions(this.extensions);\n    this.extensions.forEach(function (extension) {\n      var _a; // store extension storage in editor\n\n\n      _this12.editor.extensionStorage[extension.name] = extension.storage;\n      var context = {\n        name: extension.name,\n        options: extension.options,\n        storage: extension.storage,\n        editor: _this12.editor,\n        type: getSchemaTypeByName(extension.name, _this12.schema)\n      };\n\n      if (extension.type === 'mark') {\n        var keepOnSplit = (_a = callOrReturn(getExtensionField(extension, 'keepOnSplit', context))) !== null && _a !== void 0 ? _a : true;\n\n        if (keepOnSplit) {\n          _this12.splittableMarks.push(extension.name);\n        }\n      }\n\n      var onBeforeCreate = getExtensionField(extension, 'onBeforeCreate', context);\n\n      if (onBeforeCreate) {\n        _this12.editor.on('beforeCreate', onBeforeCreate);\n      }\n\n      var onCreate = getExtensionField(extension, 'onCreate', context);\n\n      if (onCreate) {\n        _this12.editor.on('create', onCreate);\n      }\n\n      var onUpdate = getExtensionField(extension, 'onUpdate', context);\n\n      if (onUpdate) {\n        _this12.editor.on('update', onUpdate);\n      }\n\n      var onSelectionUpdate = getExtensionField(extension, 'onSelectionUpdate', context);\n\n      if (onSelectionUpdate) {\n        _this12.editor.on('selectionUpdate', onSelectionUpdate);\n      }\n\n      var onTransaction = getExtensionField(extension, 'onTransaction', context);\n\n      if (onTransaction) {\n        _this12.editor.on('transaction', onTransaction);\n      }\n\n      var onFocus = getExtensionField(extension, 'onFocus', context);\n\n      if (onFocus) {\n        _this12.editor.on('focus', onFocus);\n      }\n\n      var onBlur = getExtensionField(extension, 'onBlur', context);\n\n      if (onBlur) {\n        _this12.editor.on('blur', onBlur);\n      }\n\n      var onDestroy = getExtensionField(extension, 'onDestroy', context);\n\n      if (onDestroy) {\n        _this12.editor.on('destroy', onDestroy);\n      }\n    });\n  }\n\n  _createClass(ExtensionManager, [{\n    key: \"commands\",\n    get: function get() {\n      var _this13 = this;\n\n      return this.extensions.reduce(function (commands, extension) {\n        var context = {\n          name: extension.name,\n          options: extension.options,\n          storage: extension.storage,\n          editor: _this13.editor,\n          type: getSchemaTypeByName(extension.name, _this13.schema)\n        };\n        var addCommands = getExtensionField(extension, 'addCommands', context);\n\n        if (!addCommands) {\n          return commands;\n        }\n\n        return _objectSpread(_objectSpread({}, commands), addCommands());\n      }, {});\n    }\n  }, {\n    key: \"plugins\",\n    get: function get() {\n      var _this14 = this;\n\n      var editor = this.editor; // With ProseMirror, first plugins within an array are executed first.\n      // In tiptap, we provide the ability to override plugins,\n      // so it feels more natural to run plugins at the end of an array first.\n      // Thats why we have to reverse the `extensions` array and sort again\n      // based on the `priority` option.\n\n      var extensions = ExtensionManager.sort(_toConsumableArray(this.extensions).reverse());\n      var inputRules = [];\n      var pasteRules = [];\n      var allPlugins = extensions.map(function (extension) {\n        var context = {\n          name: extension.name,\n          options: extension.options,\n          storage: extension.storage,\n          editor: editor,\n          type: getSchemaTypeByName(extension.name, _this14.schema)\n        };\n        var plugins = [];\n        var addKeyboardShortcuts = getExtensionField(extension, 'addKeyboardShortcuts', context);\n\n        if (addKeyboardShortcuts) {\n          var bindings = Object.fromEntries(Object.entries(addKeyboardShortcuts()).map(function (_ref83) {\n            var _ref84 = _slicedToArray(_ref83, 2),\n                shortcut = _ref84[0],\n                method = _ref84[1];\n\n            return [shortcut, function () {\n              return method({\n                editor: editor\n              });\n            }];\n          }));\n          var keyMapPlugin = keymap(bindings);\n          plugins.push(keyMapPlugin);\n        }\n\n        var addInputRules = getExtensionField(extension, 'addInputRules', context);\n\n        if (isExtensionRulesEnabled(extension, editor.options.enableInputRules) && addInputRules) {\n          inputRules.push.apply(inputRules, _toConsumableArray(addInputRules()));\n        }\n\n        var addPasteRules = getExtensionField(extension, 'addPasteRules', context);\n\n        if (isExtensionRulesEnabled(extension, editor.options.enablePasteRules) && addPasteRules) {\n          pasteRules.push.apply(pasteRules, _toConsumableArray(addPasteRules()));\n        }\n\n        var addProseMirrorPlugins = getExtensionField(extension, 'addProseMirrorPlugins', context);\n\n        if (addProseMirrorPlugins) {\n          var proseMirrorPlugins = addProseMirrorPlugins();\n          plugins.push.apply(plugins, _toConsumableArray(proseMirrorPlugins));\n        }\n\n        return plugins;\n      }).flat();\n      return [inputRulesPlugin({\n        editor: editor,\n        rules: inputRules\n      })].concat(_toConsumableArray(pasteRulesPlugin({\n        editor: editor,\n        rules: pasteRules\n      })), _toConsumableArray(allPlugins));\n    }\n  }, {\n    key: \"attributes\",\n    get: function get() {\n      return getAttributesFromExtensions(this.extensions);\n    }\n  }, {\n    key: \"nodeViews\",\n    get: function get() {\n      var _this15 = this;\n\n      var editor = this.editor;\n\n      var _splitExtensions4 = splitExtensions(this.extensions),\n          nodeExtensions = _splitExtensions4.nodeExtensions;\n\n      return Object.fromEntries(nodeExtensions.filter(function (extension) {\n        return !!getExtensionField(extension, 'addNodeView');\n      }).map(function (extension) {\n        var extensionAttributes = _this15.attributes.filter(function (attribute) {\n          return attribute.type === extension.name;\n        });\n\n        var context = {\n          name: extension.name,\n          options: extension.options,\n          storage: extension.storage,\n          editor: editor,\n          type: getNodeType(extension.name, _this15.schema)\n        };\n        var addNodeView = getExtensionField(extension, 'addNodeView', context);\n\n        if (!addNodeView) {\n          return [];\n        }\n\n        var nodeview = function nodeview(node, view, getPos, decorations) {\n          var HTMLAttributes = getRenderedAttributes(node, extensionAttributes);\n          return addNodeView()({\n            editor: editor,\n            node: node,\n            getPos: getPos,\n            decorations: decorations,\n            HTMLAttributes: HTMLAttributes,\n            extension: extension\n          });\n        };\n\n        return [extension.name, nodeview];\n      }));\n    }\n  }], [{\n    key: \"resolve\",\n    value: function resolve(extensions) {\n      var resolvedExtensions = ExtensionManager.sort(ExtensionManager.flatten(extensions));\n      var duplicatedNames = findDuplicates(resolvedExtensions.map(function (extension) {\n        return extension.name;\n      }));\n\n      if (duplicatedNames.length) {\n        console.warn(\"[tiptap warn]: Duplicate extension names found: [\".concat(duplicatedNames.map(function (item) {\n          return \"'\".concat(item, \"'\");\n        }).join(', '), \"]. This can lead to issues.\"));\n      }\n\n      return resolvedExtensions;\n    }\n  }, {\n    key: \"flatten\",\n    value: function flatten(extensions) {\n      var _this16 = this;\n\n      return extensions.map(function (extension) {\n        var context = {\n          name: extension.name,\n          options: extension.options,\n          storage: extension.storage\n        };\n        var addExtensions = getExtensionField(extension, 'addExtensions', context);\n\n        if (addExtensions) {\n          return [extension].concat(_toConsumableArray(_this16.flatten(addExtensions())));\n        }\n\n        return extension;\n      }) // `Infinity` will break TypeScript so we set a number that is probably high enough\n      .flat(10);\n    }\n  }, {\n    key: \"sort\",\n    value: function sort(extensions) {\n      var defaultPriority = 100;\n      return extensions.sort(function (a, b) {\n        var priorityA = getExtensionField(a, 'priority') || defaultPriority;\n        var priorityB = getExtensionField(b, 'priority') || defaultPriority;\n\n        if (priorityA > priorityB) {\n          return -1;\n        }\n\n        if (priorityA < priorityB) {\n          return 1;\n        }\n\n        return 0;\n      });\n    }\n  }]);\n\n  return ExtensionManager;\n}();\n\nvar EventEmitter = /*#__PURE__*/function () {\n  function EventEmitter() {\n    _classCallCheck(this, EventEmitter);\n\n    this.callbacks = {};\n  }\n\n  _createClass(EventEmitter, [{\n    key: \"on\",\n    value: function on(event, fn) {\n      if (!this.callbacks[event]) {\n        this.callbacks[event] = [];\n      }\n\n      this.callbacks[event].push(fn);\n      return this;\n    }\n  }, {\n    key: \"emit\",\n    value: function emit(event) {\n      var _this17 = this;\n\n      for (var _len3 = arguments.length, args = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {\n        args[_key3 - 1] = arguments[_key3];\n      }\n\n      var callbacks = this.callbacks[event];\n\n      if (callbacks) {\n        callbacks.forEach(function (callback) {\n          return callback.apply(_this17, args);\n        });\n      }\n\n      return this;\n    }\n  }, {\n    key: \"off\",\n    value: function off(event, fn) {\n      var callbacks = this.callbacks[event];\n\n      if (callbacks) {\n        if (fn) {\n          this.callbacks[event] = callbacks.filter(function (callback) {\n            return callback !== fn;\n          });\n        } else {\n          delete this.callbacks[event];\n        }\n      }\n\n      return this;\n    }\n  }, {\n    key: \"removeAllListeners\",\n    value: function removeAllListeners() {\n      this.callbacks = {};\n    }\n  }]);\n\n  return EventEmitter;\n}();\n\nvar style = \".ProseMirror {\\n  position: relative;\\n}\\n\\n.ProseMirror {\\n  word-wrap: break-word;\\n  white-space: pre-wrap;\\n  white-space: break-spaces;\\n  -webkit-font-variant-ligatures: none;\\n  font-variant-ligatures: none;\\n  font-feature-settings: \\\"liga\\\" 0; /* the above doesn't seem to work in Edge */\\n}\\n\\n.ProseMirror [contenteditable=\\\"false\\\"] {\\n  white-space: normal;\\n}\\n\\n.ProseMirror [contenteditable=\\\"false\\\"] [contenteditable=\\\"true\\\"] {\\n  white-space: pre-wrap;\\n}\\n\\n.ProseMirror pre {\\n  white-space: pre-wrap;\\n}\\n\\nimg.ProseMirror-separator {\\n  display: inline !important;\\n  border: none !important;\\n  margin: 0 !important;\\n  width: 1px !important;\\n  height: 1px !important;\\n}\\n\\n.ProseMirror-gapcursor {\\n  display: none;\\n  pointer-events: none;\\n  position: absolute;\\n  margin: 0;\\n}\\n\\n.ProseMirror-gapcursor:after {\\n  content: \\\"\\\";\\n  display: block;\\n  position: absolute;\\n  top: -2px;\\n  width: 20px;\\n  border-top: 1px solid black;\\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\\n}\\n\\n@keyframes ProseMirror-cursor-blink {\\n  to {\\n    visibility: hidden;\\n  }\\n}\\n\\n.ProseMirror-hideselection *::selection {\\n  background: transparent;\\n}\\n\\n.ProseMirror-hideselection *::-moz-selection {\\n  background: transparent;\\n}\\n\\n.ProseMirror-hideselection * {\\n  caret-color: transparent;\\n}\\n\\n.ProseMirror-focused .ProseMirror-gapcursor {\\n  display: block;\\n}\\n\\n.tippy-box[data-animation=fade][data-state=hidden] {\\n  opacity: 0\\n}\";\n\nvar Editor = /*#__PURE__*/function (_EventEmitter) {\n  _inherits(Editor, _EventEmitter);\n\n  var _super = _createSuper(Editor);\n\n  function Editor() {\n    var _this18;\n\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, Editor);\n\n    _this18 = _super.call(this);\n    _this18.isFocused = false;\n    _this18.extensionStorage = {};\n    _this18.options = {\n      element: document.createElement('div'),\n      content: '',\n      injectCSS: true,\n      extensions: [],\n      autofocus: false,\n      editable: true,\n      editorProps: {},\n      parseOptions: {},\n      enableInputRules: true,\n      enablePasteRules: true,\n      enableCoreExtensions: true,\n      onBeforeCreate: function onBeforeCreate() {\n        return null;\n      },\n      onCreate: function onCreate() {\n        return null;\n      },\n      onUpdate: function onUpdate() {\n        return null;\n      },\n      onSelectionUpdate: function onSelectionUpdate() {\n        return null;\n      },\n      onTransaction: function onTransaction() {\n        return null;\n      },\n      onFocus: function onFocus() {\n        return null;\n      },\n      onBlur: function onBlur() {\n        return null;\n      },\n      onDestroy: function onDestroy() {\n        return null;\n      }\n    };\n    _this18.isCapturingTransaction = false;\n    _this18.capturedTransaction = null;\n\n    _this18.setOptions(options);\n\n    _this18.createExtensionManager();\n\n    _this18.createCommandManager();\n\n    _this18.createSchema();\n\n    _this18.on('beforeCreate', _this18.options.onBeforeCreate);\n\n    _this18.emit('beforeCreate', {\n      editor: _assertThisInitialized(_this18)\n    });\n\n    _this18.createView();\n\n    _this18.injectCSS();\n\n    _this18.on('create', _this18.options.onCreate);\n\n    _this18.on('update', _this18.options.onUpdate);\n\n    _this18.on('selectionUpdate', _this18.options.onSelectionUpdate);\n\n    _this18.on('transaction', _this18.options.onTransaction);\n\n    _this18.on('focus', _this18.options.onFocus);\n\n    _this18.on('blur', _this18.options.onBlur);\n\n    _this18.on('destroy', _this18.options.onDestroy);\n\n    window.setTimeout(function () {\n      if (_this18.isDestroyed) {\n        return;\n      }\n\n      _this18.commands.focus(_this18.options.autofocus);\n\n      _this18.emit('create', {\n        editor: _assertThisInitialized(_this18)\n      });\n    }, 0);\n    return _this18;\n  }\n  /**\r\n   * Returns the editor storage.\r\n   */\n\n\n  _createClass(Editor, [{\n    key: \"storage\",\n    get: function get() {\n      return this.extensionStorage;\n    }\n    /**\r\n     * An object of all registered commands.\r\n     */\n\n  }, {\n    key: \"commands\",\n    get: function get() {\n      return this.commandManager.commands;\n    }\n    /**\r\n     * Create a command chain to call multiple commands at once.\r\n     */\n\n  }, {\n    key: \"chain\",\n    value: function chain() {\n      return this.commandManager.chain();\n    }\n    /**\r\n     * Check if a command or a command chain can be executed. Without executing it.\r\n     */\n\n  }, {\n    key: \"can\",\n    value: function can() {\n      return this.commandManager.can();\n    }\n    /**\r\n     * Inject CSS styles.\r\n     */\n\n  }, {\n    key: \"injectCSS\",\n    value: function injectCSS() {\n      if (this.options.injectCSS && document) {\n        this.css = createStyleTag(style);\n      }\n    }\n    /**\r\n     * Update editor options.\r\n     *\r\n     * @param options A list of options\r\n     */\n\n  }, {\n    key: \"setOptions\",\n    value: function setOptions() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      this.options = _objectSpread(_objectSpread({}, this.options), options);\n\n      if (!this.view || !this.state || this.isDestroyed) {\n        return;\n      }\n\n      if (this.options.editorProps) {\n        this.view.setProps(this.options.editorProps);\n      }\n\n      this.view.updateState(this.state);\n    }\n    /**\r\n     * Update editable state of the editor.\r\n     */\n\n  }, {\n    key: \"setEditable\",\n    value: function setEditable(editable) {\n      this.setOptions({\n        editable: editable\n      });\n    }\n    /**\r\n     * Returns whether the editor is editable.\r\n     */\n\n  }, {\n    key: \"isEditable\",\n    get: function get() {\n      // since plugins are applied after creating the view\n      // `editable` is always `true` for one tick.\n      // thats why we also have to check for `options.editable`\n      return this.options.editable && this.view && this.view.editable;\n    }\n    /**\r\n     * Returns the editor state.\r\n     */\n\n  }, {\n    key: \"state\",\n    get: function get() {\n      return this.view.state;\n    }\n    /**\r\n     * Register a ProseMirror plugin.\r\n     *\r\n     * @param plugin A ProseMirror plugin\r\n     * @param handlePlugins Control how to merge the plugin into the existing plugins.\r\n     */\n\n  }, {\n    key: \"registerPlugin\",\n    value: function registerPlugin(plugin, handlePlugins) {\n      var plugins = isFunction(handlePlugins) ? handlePlugins(plugin, this.state.plugins) : [].concat(_toConsumableArray(this.state.plugins), [plugin]);\n      var state = this.state.reconfigure({\n        plugins: plugins\n      });\n      this.view.updateState(state);\n    }\n    /**\r\n     * Unregister a ProseMirror plugin.\r\n     *\r\n     * @param nameOrPluginKey The plugins name\r\n     */\n\n  }, {\n    key: \"unregisterPlugin\",\n    value: function unregisterPlugin(nameOrPluginKey) {\n      if (this.isDestroyed) {\n        return;\n      }\n\n      var name = typeof nameOrPluginKey === 'string' ? \"\".concat(nameOrPluginKey, \"$\") // @ts-ignore\n      : nameOrPluginKey.key;\n      var state = this.state.reconfigure({\n        // @ts-ignore\n        plugins: this.state.plugins.filter(function (plugin) {\n          return !plugin.key.startsWith(name);\n        })\n      });\n      this.view.updateState(state);\n    }\n    /**\r\n     * Creates an extension manager.\r\n     */\n\n  }, {\n    key: \"createExtensionManager\",\n    value: function createExtensionManager() {\n      var coreExtensions = this.options.enableCoreExtensions ? Object.values(extensions) : [];\n      var allExtensions = [].concat(_toConsumableArray(coreExtensions), _toConsumableArray(this.options.extensions)).filter(function (extension) {\n        return ['extension', 'node', 'mark'].includes(extension === null || extension === void 0 ? void 0 : extension.type);\n      });\n      this.extensionManager = new ExtensionManager(allExtensions, this);\n    }\n    /**\r\n     * Creates an command manager.\r\n     */\n\n  }, {\n    key: \"createCommandManager\",\n    value: function createCommandManager() {\n      this.commandManager = new CommandManager({\n        editor: this\n      });\n    }\n    /**\r\n     * Creates a ProseMirror schema.\r\n     */\n\n  }, {\n    key: \"createSchema\",\n    value: function createSchema() {\n      this.schema = this.extensionManager.schema;\n    }\n    /**\r\n     * Creates a ProseMirror view.\r\n     */\n\n  }, {\n    key: \"createView\",\n    value: function createView() {\n      var doc = createDocument(this.options.content, this.schema, this.options.parseOptions);\n      var selection = resolveFocusPosition(doc, this.options.autofocus);\n      this.view = new EditorView(this.options.element, _objectSpread(_objectSpread({}, this.options.editorProps), {}, {\n        dispatchTransaction: this.dispatchTransaction.bind(this),\n        state: EditorState.create({\n          doc: doc,\n          selection: selection\n        })\n      })); // `editor.view` is not yet available at this time.\n      // Therefore we will add all plugins and node views directly afterwards.\n\n      var newState = this.state.reconfigure({\n        plugins: this.extensionManager.plugins\n      });\n      this.view.updateState(newState);\n      this.createNodeViews(); // Lets store the editor instance in the DOM element.\n      // So well have access to it for tests.\n\n      var dom = this.view.dom;\n      dom.editor = this;\n    }\n    /**\r\n     * Creates all node views.\r\n     */\n\n  }, {\n    key: \"createNodeViews\",\n    value: function createNodeViews() {\n      this.view.setProps({\n        nodeViews: this.extensionManager.nodeViews\n      });\n    }\n  }, {\n    key: \"captureTransaction\",\n    value: function captureTransaction(fn) {\n      this.isCapturingTransaction = true;\n      fn();\n      this.isCapturingTransaction = false;\n      var tr = this.capturedTransaction;\n      this.capturedTransaction = null;\n      return tr;\n    }\n    /**\r\n     * The callback over which to send transactions (state updates) produced by the view.\r\n     *\r\n     * @param transaction An editor state transaction\r\n     */\n\n  }, {\n    key: \"dispatchTransaction\",\n    value: function dispatchTransaction(transaction) {\n      var _this19 = this;\n\n      if (this.isCapturingTransaction) {\n        if (!this.capturedTransaction) {\n          this.capturedTransaction = transaction;\n          return;\n        }\n\n        transaction.steps.forEach(function (step) {\n          var _a;\n\n          return (_a = _this19.capturedTransaction) === null || _a === void 0 ? void 0 : _a.step(step);\n        });\n        return;\n      }\n\n      var state = this.state.apply(transaction);\n      var selectionHasChanged = !this.state.selection.eq(state.selection);\n      this.view.updateState(state);\n      this.emit('transaction', {\n        editor: this,\n        transaction: transaction\n      });\n\n      if (selectionHasChanged) {\n        this.emit('selectionUpdate', {\n          editor: this,\n          transaction: transaction\n        });\n      }\n\n      var focus = transaction.getMeta('focus');\n      var blur = transaction.getMeta('blur');\n\n      if (focus) {\n        this.emit('focus', {\n          editor: this,\n          event: focus.event,\n          transaction: transaction\n        });\n      }\n\n      if (blur) {\n        this.emit('blur', {\n          editor: this,\n          event: blur.event,\n          transaction: transaction\n        });\n      }\n\n      if (!transaction.docChanged || transaction.getMeta('preventUpdate')) {\n        return;\n      }\n\n      this.emit('update', {\n        editor: this,\n        transaction: transaction\n      });\n    }\n    /**\r\n     * Get attributes of the currently selected node or mark.\r\n     */\n\n  }, {\n    key: \"getAttributes\",\n    value: function getAttributes(nameOrType) {\n      return _getAttributes(this.state, nameOrType);\n    }\n  }, {\n    key: \"isActive\",\n    value: function isActive(nameOrAttributes, attributesOrUndefined) {\n      var name = typeof nameOrAttributes === 'string' ? nameOrAttributes : null;\n      var attributes = typeof nameOrAttributes === 'string' ? attributesOrUndefined : nameOrAttributes;\n      return _isActive(this.state, name, attributes);\n    }\n    /**\r\n     * Get the document as JSON.\r\n     */\n\n  }, {\n    key: \"getJSON\",\n    value: function getJSON() {\n      return this.state.doc.toJSON();\n    }\n    /**\r\n     * Get the document as HTML.\r\n     */\n\n  }, {\n    key: \"getHTML\",\n    value: function getHTML() {\n      return getHTMLFromFragment(this.state.doc.content, this.schema);\n    }\n    /**\r\n     * Get the document as text.\r\n     */\n\n  }, {\n    key: \"getText\",\n    value: function getText(options) {\n      var _ref85 = options || {},\n          _ref85$blockSeparator = _ref85.blockSeparator,\n          blockSeparator = _ref85$blockSeparator === void 0 ? '\\n\\n' : _ref85$blockSeparator,\n          _ref85$textSerializer = _ref85.textSerializers,\n          textSerializers = _ref85$textSerializer === void 0 ? {} : _ref85$textSerializer;\n\n      return _getText(this.state.doc, {\n        blockSeparator: blockSeparator,\n        textSerializers: _objectSpread(_objectSpread({}, textSerializers), getTextSeralizersFromSchema(this.schema))\n      });\n    }\n    /**\r\n     * Check if there is no content.\r\n     */\n\n  }, {\n    key: \"isEmpty\",\n    get: function get() {\n      return isNodeEmpty(this.state.doc);\n    }\n    /**\r\n     * Get the number of characters for the current document.\r\n     *\r\n     * @deprecated\r\n     */\n\n  }, {\n    key: \"getCharacterCount\",\n    value: function getCharacterCount() {\n      console.warn('[tiptap warn]: \"editor.getCharacterCount()\" is deprecated. Please use \"editor.storage.characterCount.characters()\" instead.');\n      return this.state.doc.content.size - 2;\n    }\n    /**\r\n     * Destroy the editor.\r\n     */\n\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      this.emit('destroy');\n\n      if (this.view) {\n        this.view.destroy();\n      }\n\n      this.removeAllListeners();\n    }\n    /**\r\n     * Check if the editor is already destroyed.\r\n     */\n\n  }, {\n    key: \"isDestroyed\",\n    get: function get() {\n      var _a; // @ts-ignore\n\n\n      return !((_a = this.view) === null || _a === void 0 ? void 0 : _a.docView);\n    }\n  }]);\n\n  return Editor;\n}(EventEmitter);\n\nvar Node = /*#__PURE__*/function () {\n  function Node() {\n    var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, Node);\n\n    this.type = 'node';\n    this.name = 'node';\n    this.parent = null;\n    this.child = null;\n    this.config = {\n      name: this.name,\n      defaultOptions: {}\n    };\n    this.config = _objectSpread(_objectSpread({}, this.config), config);\n    this.name = this.config.name;\n\n    if (config.defaultOptions) {\n      console.warn(\"[tiptap warn]: BREAKING CHANGE: \\\"defaultOptions\\\" is deprecated. Please use \\\"addOptions\\\" instead. Found in extension: \\\"\".concat(this.name, \"\\\".\"));\n    } // TODO: remove `addOptions` fallback\n\n\n    this.options = this.config.defaultOptions;\n\n    if (this.config.addOptions) {\n      this.options = callOrReturn(getExtensionField(this, 'addOptions', {\n        name: this.name\n      }));\n    }\n\n    this.storage = callOrReturn(getExtensionField(this, 'addStorage', {\n      name: this.name,\n      options: this.options\n    })) || {};\n  }\n\n  _createClass(Node, [{\n    key: \"configure\",\n    value: function configure() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      // return a new instance so we can use the same extension\n      // with different calls of `configure`\n      var extension = this.extend();\n      extension.options = mergeDeep(this.options, options);\n      extension.storage = callOrReturn(getExtensionField(extension, 'addStorage', {\n        name: extension.name,\n        options: extension.options\n      }));\n      return extension;\n    }\n  }, {\n    key: \"extend\",\n    value: function extend() {\n      var extendedConfig = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var extension = new Node(extendedConfig);\n      extension.parent = this;\n      this.child = extension;\n      extension.name = extendedConfig.name ? extendedConfig.name : extension.parent.name;\n\n      if (extendedConfig.defaultOptions) {\n        console.warn(\"[tiptap warn]: BREAKING CHANGE: \\\"defaultOptions\\\" is deprecated. Please use \\\"addOptions\\\" instead. Found in extension: \\\"\".concat(extension.name, \"\\\".\"));\n      }\n\n      extension.options = callOrReturn(getExtensionField(extension, 'addOptions', {\n        name: extension.name\n      }));\n      extension.storage = callOrReturn(getExtensionField(extension, 'addStorage', {\n        name: extension.name,\n        options: extension.options\n      }));\n      return extension;\n    }\n  }], [{\n    key: \"create\",\n    value: function create() {\n      var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      return new Node(config);\n    }\n  }]);\n\n  return Node;\n}();\n\nvar Mark = /*#__PURE__*/function () {\n  function Mark() {\n    var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, Mark);\n\n    this.type = 'mark';\n    this.name = 'mark';\n    this.parent = null;\n    this.child = null;\n    this.config = {\n      name: this.name,\n      defaultOptions: {}\n    };\n    this.config = _objectSpread(_objectSpread({}, this.config), config);\n    this.name = this.config.name;\n\n    if (config.defaultOptions) {\n      console.warn(\"[tiptap warn]: BREAKING CHANGE: \\\"defaultOptions\\\" is deprecated. Please use \\\"addOptions\\\" instead. Found in extension: \\\"\".concat(this.name, \"\\\".\"));\n    } // TODO: remove `addOptions` fallback\n\n\n    this.options = this.config.defaultOptions;\n\n    if (this.config.addOptions) {\n      this.options = callOrReturn(getExtensionField(this, 'addOptions', {\n        name: this.name\n      }));\n    }\n\n    this.storage = callOrReturn(getExtensionField(this, 'addStorage', {\n      name: this.name,\n      options: this.options\n    })) || {};\n  }\n\n  _createClass(Mark, [{\n    key: \"configure\",\n    value: function configure() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      // return a new instance so we can use the same extension\n      // with different calls of `configure`\n      var extension = this.extend();\n      extension.options = mergeDeep(this.options, options);\n      extension.storage = callOrReturn(getExtensionField(extension, 'addStorage', {\n        name: extension.name,\n        options: extension.options\n      }));\n      return extension;\n    }\n  }, {\n    key: \"extend\",\n    value: function extend() {\n      var extendedConfig = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var extension = new Mark(extendedConfig);\n      extension.parent = this;\n      this.child = extension;\n      extension.name = extendedConfig.name ? extendedConfig.name : extension.parent.name;\n\n      if (extendedConfig.defaultOptions) {\n        console.warn(\"[tiptap warn]: BREAKING CHANGE: \\\"defaultOptions\\\" is deprecated. Please use \\\"addOptions\\\" instead. Found in extension: \\\"\".concat(extension.name, \"\\\".\"));\n      }\n\n      extension.options = callOrReturn(getExtensionField(extension, 'addOptions', {\n        name: extension.name\n      }));\n      extension.storage = callOrReturn(getExtensionField(extension, 'addStorage', {\n        name: extension.name,\n        options: extension.options\n      }));\n      return extension;\n    }\n  }], [{\n    key: \"create\",\n    value: function create() {\n      var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      return new Mark(config);\n    }\n  }]);\n\n  return Mark;\n}();\n\nvar NodeView = /*#__PURE__*/function () {\n  function NodeView(component, props, options) {\n    _classCallCheck(this, NodeView);\n\n    this.isDragging = false;\n    this.component = component;\n    this.editor = props.editor;\n    this.options = _objectSpread({\n      stopEvent: null,\n      ignoreMutation: null\n    }, options);\n    this.extension = props.extension;\n    this.node = props.node;\n    this.decorations = props.decorations;\n    this.getPos = props.getPos;\n    this.mount();\n  }\n\n  _createClass(NodeView, [{\n    key: \"mount\",\n    value: function mount() {\n      // eslint-disable-next-line\n      return;\n    }\n  }, {\n    key: \"dom\",\n    get: function get() {\n      return null;\n    }\n  }, {\n    key: \"contentDOM\",\n    get: function get() {\n      return null;\n    }\n  }, {\n    key: \"onDragStart\",\n    value: function onDragStart(event) {\n      var _a, _b, _c;\n\n      var view = this.editor.view;\n      var target = event.target; // get the drag handle element\n      // `closest` is not available for text nodes so we may have to use its parent\n\n      var dragHandle = target.nodeType === 3 ? (_a = target.parentElement) === null || _a === void 0 ? void 0 : _a.closest('[data-drag-handle]') : target.closest('[data-drag-handle]');\n\n      if (!this.dom || ((_b = this.contentDOM) === null || _b === void 0 ? void 0 : _b.contains(target)) || !dragHandle) {\n        return;\n      }\n\n      var x = 0;\n      var y = 0; // calculate offset for drag element if we use a different drag handle element\n\n      if (this.dom !== dragHandle) {\n        var domBox = this.dom.getBoundingClientRect();\n        var handleBox = dragHandle.getBoundingClientRect();\n        x = handleBox.x - domBox.x + event.offsetX;\n        y = handleBox.y - domBox.y + event.offsetY;\n      }\n\n      (_c = event.dataTransfer) === null || _c === void 0 ? void 0 : _c.setDragImage(this.dom, x, y); // we need to tell ProseMirror that we want to move the whole node\n      // so we create a NodeSelection\n\n      var selection = NodeSelection.create(view.state.doc, this.getPos());\n      var transaction = view.state.tr.setSelection(selection);\n      view.dispatch(transaction);\n    }\n  }, {\n    key: \"stopEvent\",\n    value: function stopEvent(event) {\n      var _this20 = this;\n\n      var _a;\n\n      if (!this.dom) {\n        return false;\n      }\n\n      if (typeof this.options.stopEvent === 'function') {\n        return this.options.stopEvent({\n          event: event\n        });\n      }\n\n      var target = event.target;\n      var isInElement = this.dom.contains(target) && !((_a = this.contentDOM) === null || _a === void 0 ? void 0 : _a.contains(target)); // any event from child nodes should be handled by ProseMirror\n\n      if (!isInElement) {\n        return false;\n      }\n\n      var isDropEvent = event.type === 'drop';\n      var isInput = ['INPUT', 'BUTTON', 'SELECT', 'TEXTAREA'].includes(target.tagName) || target.isContentEditable; // any input event within node views should be ignored by ProseMirror\n\n      if (isInput && !isDropEvent) {\n        return true;\n      }\n\n      var isEditable = this.editor.isEditable;\n      var isDragging = this.isDragging;\n      var isDraggable = !!this.node.type.spec.draggable;\n      var isSelectable = NodeSelection.isSelectable(this.node);\n      var isCopyEvent = event.type === 'copy';\n      var isPasteEvent = event.type === 'paste';\n      var isCutEvent = event.type === 'cut';\n      var isClickEvent = event.type === 'mousedown';\n      var isDragEvent = event.type.startsWith('drag'); // ProseMirror tries to drag selectable nodes\n      // even if `draggable` is set to `false`\n      // this fix prevents that\n\n      if (!isDraggable && isSelectable && isDragEvent) {\n        event.preventDefault();\n      }\n\n      if (isDraggable && isDragEvent && !isDragging) {\n        event.preventDefault();\n        return false;\n      } // we have to store that dragging started\n\n\n      if (isDraggable && isEditable && !isDragging && isClickEvent) {\n        var dragHandle = target.closest('[data-drag-handle]');\n        var isValidDragHandle = dragHandle && (this.dom === dragHandle || this.dom.contains(dragHandle));\n\n        if (isValidDragHandle) {\n          this.isDragging = true;\n          document.addEventListener('dragend', function () {\n            _this20.isDragging = false;\n          }, {\n            once: true\n          });\n          document.addEventListener('mouseup', function () {\n            _this20.isDragging = false;\n          }, {\n            once: true\n          });\n        }\n      } // these events are handled by prosemirror\n\n\n      if (isDragging || isDropEvent || isCopyEvent || isPasteEvent || isCutEvent || isClickEvent && isSelectable) {\n        return false;\n      }\n\n      return true;\n    }\n  }, {\n    key: \"ignoreMutation\",\n    value: function ignoreMutation(mutation) {\n      if (!this.dom || !this.contentDOM) {\n        return true;\n      }\n\n      if (typeof this.options.ignoreMutation === 'function') {\n        return this.options.ignoreMutation({\n          mutation: mutation\n        });\n      } // a leaf/atom node is like a black box for ProseMirror\n      // and should be fully handled by the node view\n\n\n      if (this.node.isLeaf || this.node.isAtom) {\n        return true;\n      } // ProseMirror should handle any selections\n\n\n      if (mutation.type === 'selection') {\n        return false;\n      } // try to prevent a bug on iOS that will break node views on enter\n      // this is because ProseMirror cant preventDispatch on enter\n      // this will lead to a re-render of the node view on enter\n      // see: https://github.com/ueberdosis/tiptap/issues/1214\n\n\n      if (this.dom.contains(mutation.target) && mutation.type === 'childList' && isiOS() && this.editor.isFocused) {\n        var changedNodes = [].concat(_toConsumableArray(Array.from(mutation.addedNodes)), _toConsumableArray(Array.from(mutation.removedNodes))); // well check if every changed node is contentEditable\n        // to make sure its probably mutated by ProseMirror\n\n        if (changedNodes.every(function (node) {\n          return node.isContentEditable;\n        })) {\n          return false;\n        }\n      } // we will allow mutation contentDOM with attributes\n      // so we can for example adding classes within our node view\n\n\n      if (this.contentDOM === mutation.target && mutation.type === 'attributes') {\n        return true;\n      } // ProseMirror should handle any changes within contentDOM\n\n\n      if (this.contentDOM.contains(mutation.target)) {\n        return false;\n      }\n\n      return true;\n    }\n  }, {\n    key: \"updateAttributes\",\n    value: function updateAttributes(attributes) {\n      var _this21 = this;\n\n      this.editor.commands.command(function (_ref86) {\n        var tr = _ref86.tr;\n\n        var pos = _this21.getPos();\n\n        tr.setNodeMarkup(pos, undefined, _objectSpread(_objectSpread({}, _this21.node.attrs), attributes));\n        return true;\n      });\n    }\n  }, {\n    key: \"deleteNode\",\n    value: function deleteNode() {\n      var from = this.getPos();\n      var to = from + this.node.nodeSize;\n      this.editor.commands.deleteRange({\n        from: from,\n        to: to\n      });\n    }\n  }]);\n\n  return NodeView;\n}();\n\nvar Tracker = /*#__PURE__*/function () {\n  function Tracker(transaction) {\n    _classCallCheck(this, Tracker);\n\n    this.transaction = transaction;\n    this.currentStep = this.transaction.steps.length;\n  }\n\n  _createClass(Tracker, [{\n    key: \"map\",\n    value: function map(position) {\n      var deleted = false;\n      var mappedPosition = this.transaction.steps.slice(this.currentStep).reduce(function (newPosition, step) {\n        var mapResult = step.getMap().mapResult(newPosition);\n\n        if (mapResult.deleted) {\n          deleted = true;\n        }\n\n        return mapResult.pos;\n      }, position);\n      return {\n        position: mappedPosition,\n        deleted: deleted\n      };\n    }\n  }]);\n\n  return Tracker;\n}();\n/**\r\n * Build an input rule that adds a node when the\r\n * matched text is typed into it.\r\n */\n\n\nfunction nodeInputRule(config) {\n  return new InputRule({\n    find: config.find,\n    handler: function handler(_ref87) {\n      var state = _ref87.state,\n          range = _ref87.range,\n          match = _ref87.match;\n      var attributes = callOrReturn(config.getAttributes, undefined, match) || {};\n      var tr = state.tr;\n      var start = range.from;\n      var end = range.to;\n\n      if (match[1]) {\n        var offset = match[0].lastIndexOf(match[1]);\n        var matchStart = start + offset;\n\n        if (matchStart > end) {\n          matchStart = end;\n        } else {\n          end = matchStart + match[1].length;\n        } // insert last typed character\n\n\n        var lastChar = match[0][match[0].length - 1];\n        tr.insertText(lastChar, start + match[0].length - 1); // insert node from input rule\n\n        tr.replaceWith(matchStart, end, config.type.create(attributes));\n      } else if (match[0]) {\n        tr.replaceWith(start, end, config.type.create(attributes));\n      }\n    }\n  });\n}\n\nfunction getMarksBetween(from, to, doc) {\n  var marks = []; // get all inclusive marks on empty selection\n\n  if (from === to) {\n    doc.resolve(from).marks().forEach(function (mark) {\n      var $pos = doc.resolve(from - 1);\n      var range = getMarkRange($pos, mark.type);\n\n      if (!range) {\n        return;\n      }\n\n      marks.push(_objectSpread({\n        mark: mark\n      }, range));\n    });\n  } else {\n    doc.nodesBetween(from, to, function (node, pos) {\n      marks.push.apply(marks, _toConsumableArray(node.marks.map(function (mark) {\n        return {\n          from: pos,\n          to: pos + node.nodeSize,\n          mark: mark\n        };\n      })));\n    });\n  }\n\n  return marks;\n}\n/**\r\n * Build an input rule that adds a mark when the\r\n * matched text is typed into it.\r\n */\n\n\nfunction markInputRule(config) {\n  return new InputRule({\n    find: config.find,\n    handler: function handler(_ref88) {\n      var state = _ref88.state,\n          range = _ref88.range,\n          match = _ref88.match;\n      var attributes = callOrReturn(config.getAttributes, undefined, match);\n\n      if (attributes === false || attributes === null) {\n        return null;\n      }\n\n      var tr = state.tr;\n      var captureGroup = match[match.length - 1];\n      var fullMatch = match[0];\n      var markEnd = range.to;\n\n      if (captureGroup) {\n        var startSpaces = fullMatch.search(/\\S/);\n        var textStart = range.from + fullMatch.indexOf(captureGroup);\n        var textEnd = textStart + captureGroup.length;\n        var excludedMarks = getMarksBetween(range.from, range.to, state.doc).filter(function (item) {\n          // @ts-ignore\n          var excluded = item.mark.type.excluded;\n          return excluded.find(function (type) {\n            return type === config.type && type !== item.mark.type;\n          });\n        }).filter(function (item) {\n          return item.to > textStart;\n        });\n\n        if (excludedMarks.length) {\n          return null;\n        }\n\n        if (textEnd < range.to) {\n          tr.delete(textEnd, range.to);\n        }\n\n        if (textStart > range.from) {\n          tr.delete(range.from + startSpaces, textStart);\n        }\n\n        markEnd = range.from + startSpaces + captureGroup.length;\n        tr.addMark(range.from + startSpaces, markEnd, config.type.create(attributes || {}));\n        tr.removeStoredMark(config.type);\n      }\n    }\n  });\n}\n/**\r\n * Build an input rule that changes the type of a textblock when the\r\n * matched text is typed into it. When using a regular expresion youll\r\n * probably want the regexp to start with `^`, so that the pattern can\r\n * only occur at the start of a textblock.\r\n */\n\n\nfunction textblockTypeInputRule(config) {\n  return new InputRule({\n    find: config.find,\n    handler: function handler(_ref89) {\n      var state = _ref89.state,\n          range = _ref89.range,\n          match = _ref89.match;\n      var $start = state.doc.resolve(range.from);\n      var attributes = callOrReturn(config.getAttributes, undefined, match) || {};\n\n      if (!$start.node(-1).canReplaceWith($start.index(-1), $start.indexAfter(-1), config.type)) {\n        return null;\n      }\n\n      state.tr.delete(range.from, range.to).setBlockType(range.from, range.from, config.type, attributes);\n    }\n  });\n}\n/**\r\n * Build an input rule that replaces text when the\r\n * matched text is typed into it.\r\n */\n\n\nfunction textInputRule(config) {\n  return new InputRule({\n    find: config.find,\n    handler: function handler(_ref90) {\n      var state = _ref90.state,\n          range = _ref90.range,\n          match = _ref90.match;\n      var insert = config.replace;\n      var start = range.from;\n      var end = range.to;\n\n      if (match[1]) {\n        var offset = match[0].lastIndexOf(match[1]);\n        insert += match[0].slice(offset + match[1].length);\n        start += offset;\n        var cutOff = start - end;\n\n        if (cutOff > 0) {\n          insert = match[0].slice(offset - cutOff, offset) + insert;\n          start = end;\n        }\n      }\n\n      state.tr.insertText(insert, start, end);\n    }\n  });\n}\n/**\r\n * Build an input rule for automatically wrapping a textblock when a\r\n * given string is typed. When using a regular expresion youll\r\n * probably want the regexp to start with `^`, so that the pattern can\r\n * only occur at the start of a textblock.\r\n *\r\n * `type` is the type of node to wrap in.\r\n *\r\n * By default, if theres a node with the same type above the newly\r\n * wrapped node, the rule will try to join those\r\n * two nodes. You can pass a join predicate, which takes a regular\r\n * expression match and the node before the wrapped node, and can\r\n * return a boolean to indicate whether a join should happen.\r\n */\n\n\nfunction wrappingInputRule(config) {\n  return new InputRule({\n    find: config.find,\n    handler: function handler(_ref91) {\n      var state = _ref91.state,\n          range = _ref91.range,\n          match = _ref91.match;\n      var attributes = callOrReturn(config.getAttributes, undefined, match) || {};\n      var tr = state.tr.delete(range.from, range.to);\n      var $start = tr.doc.resolve(range.from);\n      var blockRange = $start.blockRange();\n      var wrapping = blockRange && findWrapping(blockRange, config.type, attributes);\n\n      if (!wrapping) {\n        return null;\n      }\n\n      tr.wrap(blockRange, wrapping);\n      var before = tr.doc.resolve(range.from - 1).nodeBefore;\n\n      if (before && before.type === config.type && canJoin(tr.doc, range.from - 1) && (!config.joinPredicate || config.joinPredicate(match, before))) {\n        tr.join(range.from - 1);\n      }\n    }\n  });\n}\n/**\r\n * Build an paste rule that adds a mark when the\r\n * matched text is pasted into it.\r\n */\n\n\nfunction markPasteRule(config) {\n  return new PasteRule({\n    find: config.find,\n    handler: function handler(_ref92) {\n      var state = _ref92.state,\n          range = _ref92.range,\n          match = _ref92.match;\n      var attributes = callOrReturn(config.getAttributes, undefined, match);\n\n      if (attributes === false || attributes === null) {\n        return null;\n      }\n\n      var tr = state.tr;\n      var captureGroup = match[match.length - 1];\n      var fullMatch = match[0];\n      var markEnd = range.to;\n\n      if (captureGroup) {\n        var startSpaces = fullMatch.search(/\\S/);\n        var textStart = range.from + fullMatch.indexOf(captureGroup);\n        var textEnd = textStart + captureGroup.length;\n        var excludedMarks = getMarksBetween(range.from, range.to, state.doc).filter(function (item) {\n          // @ts-ignore\n          var excluded = item.mark.type.excluded;\n          return excluded.find(function (type) {\n            return type === config.type && type !== item.mark.type;\n          });\n        }).filter(function (item) {\n          return item.to > textStart;\n        });\n\n        if (excludedMarks.length) {\n          return null;\n        }\n\n        if (textEnd < range.to) {\n          tr.delete(textEnd, range.to);\n        }\n\n        if (textStart > range.from) {\n          tr.delete(range.from + startSpaces, textStart);\n        }\n\n        markEnd = range.from + startSpaces + captureGroup.length;\n        tr.addMark(range.from + startSpaces, markEnd, config.type.create(attributes || {}));\n        tr.removeStoredMark(config.type);\n      }\n    }\n  });\n}\n/**\r\n * Build an paste rule that replaces text when the\r\n * matched text is pasted into it.\r\n */\n\n\nfunction textPasteRule(config) {\n  return new PasteRule({\n    find: config.find,\n    handler: function handler(_ref93) {\n      var state = _ref93.state,\n          range = _ref93.range,\n          match = _ref93.match;\n      var insert = config.replace;\n      var start = range.from;\n      var end = range.to;\n\n      if (match[1]) {\n        var offset = match[0].lastIndexOf(match[1]);\n        insert += match[0].slice(offset + match[1].length);\n        start += offset;\n        var cutOff = start - end;\n\n        if (cutOff > 0) {\n          insert = match[0].slice(offset - cutOff, offset) + insert;\n          start = end;\n        }\n      }\n\n      state.tr.insertText(insert, start, end);\n    }\n  });\n} // source: https://stackoverflow.com/a/6969486\n\n\nfunction escapeForRegEx(string) {\n  return string.replace(/[-/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&');\n}\n/**\r\n * Returns a new `Transform` based on all steps of the passed transactions.\r\n */\n\n\nfunction combineTransactionSteps(oldDoc, transactions) {\n  var transform = new Transform(oldDoc);\n  transactions.forEach(function (transaction) {\n    transaction.steps.forEach(function (step) {\n      transform.step(step);\n    });\n  });\n  return transform;\n}\n\nfunction defaultBlockAt(match) {\n  for (var i = 0; i < match.edgeCount; i += 1) {\n    var _match$edge2 = match.edge(i),\n        type = _match$edge2.type;\n\n    if (type.isTextblock && !type.hasRequiredAttrs()) {\n      return type;\n    }\n  }\n\n  return null;\n}\n\nfunction findChildren(node, predicate) {\n  var nodesWithPos = [];\n  node.descendants(function (child, pos) {\n    if (predicate(child)) {\n      nodesWithPos.push({\n        node: child,\n        pos: pos\n      });\n    }\n  });\n  return nodesWithPos;\n}\n/**\r\n * Same as `findChildren` but searches only within a `range`.\r\n */\n\n\nfunction findChildrenInRange(node, range, predicate) {\n  var nodesWithPos = []; // if (range.from === range.to) {\n  //   const nodeAt = node.nodeAt(range.from)\n  //   if (nodeAt) {\n  //     nodesWithPos.push({\n  //       node: nodeAt,\n  //       pos: range.from,\n  //     })\n  //   }\n  // }\n\n  node.nodesBetween(range.from, range.to, function (child, pos) {\n    if (predicate(child)) {\n      nodesWithPos.push({\n        node: child,\n        pos: pos\n      });\n    }\n  });\n  return nodesWithPos;\n}\n\nfunction getSchema(extensions) {\n  var resolvedExtensions = ExtensionManager.resolve(extensions);\n  return getSchemaByResolvedExtensions(resolvedExtensions);\n}\n\nfunction generateHTML(doc, extensions) {\n  var schema = getSchema(extensions);\n  var contentNode = Node$1.fromJSON(schema, doc);\n  return getHTMLFromFragment(contentNode.content, schema);\n}\n\nfunction generateJSON(html, extensions) {\n  var schema = getSchema(extensions);\n  var dom = elementFromString(html);\n  return DOMParser.fromSchema(schema).parse(dom).toJSON();\n}\n\nfunction generateText(doc, extensions, options) {\n  var _ref94 = options || {},\n      _ref94$blockSeparator = _ref94.blockSeparator,\n      blockSeparator = _ref94$blockSeparator === void 0 ? '\\n\\n' : _ref94$blockSeparator,\n      _ref94$textSerializer = _ref94.textSerializers,\n      textSerializers = _ref94$textSerializer === void 0 ? {} : _ref94$textSerializer;\n\n  var schema = getSchema(extensions);\n  var contentNode = Node$1.fromJSON(schema, doc);\n  return _getText(contentNode, {\n    blockSeparator: blockSeparator,\n    textSerializers: _objectSpread(_objectSpread({}, textSerializers), getTextSeralizersFromSchema(schema))\n  });\n}\n/**\r\n * Removes duplicated values within an array.\r\n * Supports numbers, strings and objects.\r\n */\n\n\nfunction removeDuplicates(array) {\n  var by = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : JSON.stringify;\n  var seen = {};\n  return array.filter(function (item) {\n    var key = by(item);\n    return Object.prototype.hasOwnProperty.call(seen, key) ? false : seen[key] = true;\n  });\n}\n/**\r\n * Removes duplicated ranges and ranges that are\r\n * fully captured by other ranges.\r\n */\n\n\nfunction simplifyChangedRanges(changes) {\n  var uniqueChanges = removeDuplicates(changes);\n  return uniqueChanges.length === 1 ? uniqueChanges : uniqueChanges.filter(function (change, index) {\n    var rest = uniqueChanges.filter(function (_, i) {\n      return i !== index;\n    });\n    return !rest.some(function (otherChange) {\n      return change.oldRange.from >= otherChange.oldRange.from && change.oldRange.to <= otherChange.oldRange.to && change.newRange.from >= otherChange.newRange.from && change.newRange.to <= otherChange.newRange.to;\n    });\n  });\n}\n/**\r\n * Returns a list of changed ranges\r\n * based on the first and last state of all steps.\r\n */\n\n\nfunction getChangedRanges(transform) {\n  var mapping = transform.mapping,\n      steps = transform.steps;\n  var changes = [];\n  mapping.maps.forEach(function (stepMap, index) {\n    var ranges = []; // This accounts for step changes where no range was actually altered\n    // e.g. when setting a mark, node attribute, etc.\n    // @ts-ignore\n\n    if (!stepMap.ranges.length) {\n      var _steps$index = steps[index],\n          from = _steps$index.from,\n          to = _steps$index.to;\n\n      if (from === undefined || to === undefined) {\n        return;\n      }\n\n      ranges.push({\n        from: from,\n        to: to\n      });\n    } else {\n      stepMap.forEach(function (from, to) {\n        ranges.push({\n          from: from,\n          to: to\n        });\n      });\n    }\n\n    ranges.forEach(function (_ref95) {\n      var from = _ref95.from,\n          to = _ref95.to;\n      var newStart = mapping.slice(index).map(from, -1);\n      var newEnd = mapping.slice(index).map(to);\n      var oldStart = mapping.invert().map(newStart, -1);\n      var oldEnd = mapping.invert().map(newEnd);\n      changes.push({\n        oldRange: {\n          from: oldStart,\n          to: oldEnd\n        },\n        newRange: {\n          from: newStart,\n          to: newEnd\n        }\n      });\n    });\n  });\n  return simplifyChangedRanges(changes);\n}\n\nfunction getDebugJSON(node) {\n  var startOffset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  var isTopNode = node.type === node.type.schema.topNodeType;\n  var increment = isTopNode ? 0 : 1;\n  var from = startOffset;\n  var to = from + node.nodeSize;\n  var marks = node.marks.map(function (mark) {\n    var output = {\n      type: mark.type.name\n    };\n\n    if (Object.keys(mark.attrs).length) {\n      output.attrs = _objectSpread({}, mark.attrs);\n    }\n\n    return output;\n  });\n\n  var attrs = _objectSpread({}, node.attrs);\n\n  var output = {\n    type: node.type.name,\n    from: from,\n    to: to\n  };\n\n  if (Object.keys(attrs).length) {\n    output.attrs = attrs;\n  }\n\n  if (marks.length) {\n    output.marks = marks;\n  }\n\n  if (node.content.childCount) {\n    output.content = [];\n    node.forEach(function (child, offset) {\n      var _a;\n\n      (_a = output.content) === null || _a === void 0 ? void 0 : _a.push(getDebugJSON(child, startOffset + offset + increment));\n    });\n  }\n\n  if (node.text) {\n    output.text = node.text;\n  }\n\n  return output;\n}\n\nfunction isNodeSelection(value) {\n  return isObject(value) && value instanceof NodeSelection;\n}\n\nfunction posToDOMRect(view, from, to) {\n  var minPos = 0;\n  var maxPos = view.state.doc.content.size;\n  var resolvedFrom = minMax(from, minPos, maxPos);\n  var resolvedEnd = minMax(to, minPos, maxPos);\n  var start = view.coordsAtPos(resolvedFrom);\n  var end = view.coordsAtPos(resolvedEnd, -1);\n  var top = Math.min(start.top, end.top);\n  var bottom = Math.max(start.bottom, end.bottom);\n  var left = Math.min(start.left, end.left);\n  var right = Math.max(start.right, end.right);\n  var width = right - left;\n  var height = bottom - top;\n  var x = left;\n  var y = top;\n  var data = {\n    top: top,\n    bottom: bottom,\n    left: left,\n    right: right,\n    width: width,\n    height: height,\n    x: x,\n    y: y\n  };\n  return _objectSpread(_objectSpread({}, data), {}, {\n    toJSON: function toJSON() {\n      return data;\n    }\n  });\n}\n\nexport { CommandManager, Editor, Extension, InputRule, Mark, Node, NodeView, PasteRule, Tracker, callOrReturn, combineTransactionSteps, defaultBlockAt, escapeForRegEx, extensions, findChildren, findChildrenInRange, findParentNode, findParentNodeClosestToPos, generateHTML, generateJSON, generateText, _getAttributes as getAttributes, getChangedRanges, getDebugJSON, getExtensionField, getHTMLFromFragment, getMarkAttributes, getMarkRange, getMarkType, getMarksBetween, getNodeAttributes, getNodeType, getSchema, _getText as getText, getTextBetween, inputRulesPlugin, _isActive as isActive, isList, isMarkActive, isNodeActive, isNodeEmpty, isNodeSelection, isTextSelection, markInputRule, markPasteRule, mergeAttributes, nodeInputRule, pasteRulesPlugin, posToDOMRect, textInputRule, textPasteRule, textblockTypeInputRule, wrappingInputRule };"],"names":["_createSuper","Derived","hasNativeReflectConstruct","Reflect","construct","sham","Proxy","Boolean","prototype","valueOf","call","e","_isNativeReflectConstruct","result","Super","NewTarget","this","constructor","arguments","apply","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","_objectSpread","target","i","length","source","forEach","key","getOwnPropertyDescriptors","defineProperties","defineProperty","isPlainObject","value","toString","slice","getType","getPrototypeOf","mergeDeep","output","assign","isFunction","callOrReturn","context","undefined","_len","props","Array","_key","bind","getExtensionField","extension","field","config","parent","Extension","type","name","child","defaultOptions","console","warn","concat","options","addOptions","storage","extend","extendedConfig","getTextBetween","startNode","range","from","to","_ref","_ref$blockSeparator","blockSeparator","_ref$textSerializers","textSerializers","text","separated","nodesBetween","node","pos","index","_a","textSerializer","isBlock","isText","Math","max","getTextSeralizersFromSchema","schema","fromEntries","entries","nodes","_ref2","spec","toText","map","_ref4","_ref5","ClipboardTextSerializer","create","addProseMirrorPlugins","_this","clipboardTextSerializer","editor","state","doc","ranges","selection","min","$from","$to","blur$1","freeze","__proto__","blur","_ref6","view","requestAnimationFrame","isDestroyed","dom","window","getSelection","removeAllRanges","clearContent$1","clearContent","emitUpdate","_ref7","commands","setContent","clearNodes$1","clearNodes","_ref8","tr","dispatch","_ref9","mapping","$mappedFrom","resolve","$mappedTo","nodeSize","nodeRange","blockRange","targetLiftDepth","isTextblock","defaultType","contentMatchAt","setNodeMarkup","start","lift","command$1","command","fn","createParagraphNear$1","createParagraphNear","_ref10","getNodeType","nameOrType","Error","deleteNode$1","deleteNode","typeOrName","_ref11","$pos","$anchor","depth","before","after","delete","scrollIntoView","deleteRange$1","deleteRange","_ref12","deleteSelection$1","deleteSelection","_ref13","enter$1","enter","_ref14","keyboardShortcut","exitCode$1","exitCode","_ref15","getMarkType","marks","isRegExp","objectIncludes","object1","object2","strict","every","test","findMarkInSet","attributes","find","item","attrs","isMarkInSet","getMarkRange","childAfter","parentOffset","mark","startIndex","startPos","offset","endIndex","endPos","isInSet","childCount","extendMarkRange$1","extendMarkRange","_ref16","newSelection","setSelection","first$1","first","items","isObject","isArray","substring","isClass","isTextSelection","isiOS","includes","navigator","platform","userAgent","document","minMax","resolveFocusPosition","position","selectionAtStart","selectionAtEnd","minPos","maxPos","content","size","focus$1","focus","_ref17","delayedFocus","hasFocus","isSameSelection","eq","storedMarks","setStoredMarks","forEach$1","insertContent$1","insertContent","_ref18","insertContentAt","elementFromString","wrappedValue","DOMParser","parseFromString","body","createNodeFromContent","parseOptions","nodeFromJSON","error","parser","parseSlice","parse","insertContentAt$1","_ref19","updateSelection","preserveWhitespace","_ref20","isOnlyTextContent","isOnlyBlockContent","startsWith","check","code","insertText","replaceWith","startLen","bias","last","steps","step","maps","end","_from","_to","_newFrom","newTo","selectionToInsertionEnd","joinBackward$1","joinBackward","_ref21","joinForward$1","joinForward","_ref22","isMacOS","keyboardShortcut$1","_ref23","alt","ctrl","shift","meta","parts","split","mod","normalizeKeyName","event","KeyboardEvent","altKey","ctrlKey","metaKey","shiftKey","bubbles","cancelable","capturedTransaction","captureTransaction","someProp","f","newStep","maybeStep","isNodeActive","_state$selection","empty","nodeRanges","relativeFrom","relativeTo","selectionRange","matchedNodeRanges","reduce","sum","lift$1","_ref24","liftEmptyBlock$1","liftEmptyBlock","_ref25","liftListItem$1","liftListItem","_ref26","newlineInCode$1","newlineInCode","_ref27","getSchemaTypeNameByName","deleteProps","obj","propOrProps","newObj","prop","resetAttributes$1","resetAttributes","_ref28","nodeType","markType","schemaType","addMark","scrollIntoView$1","_ref29","selectAll$1","selectAll","_ref30","setTextSelection","selectNodeBackward$1","selectNodeBackward","_ref31","selectNodeForward$1","selectNodeForward","_ref32","selectParentNode$1","selectParentNode","_ref33","selectTextblockEnd$1","selectTextblockEnd","_ref34","selectTextblockStart$1","selectTextblockStart","_ref35","createDocument","setContent$1","_ref36","replaceSelectionWith","setMeta","getMarkAttributes","_state$selection2","$head","markItem","setMark$1","setMark","_ref37","oldAttributes","addStoredMark","trimmedFrom","trimmedTo","setMeta$1","_ref38","setNode$1","setNode","_ref39","chain","_ref40","_ref41","updatedState","run","setNodeSelection$1","setNodeSelection","_ref42","resolvedPos","setTextSelection$1","_ref43","_ref44","resolvedFrom","resolvedEnd","sinkListItem$1","sinkListItem","_ref45","getSplittedAttributes","extensionAttributes","typeName","_ref46","extensionAttribute","attribute","keepOnSplit","defaultBlockAt$1","match","edgeCount","edge","hasRequiredAttrs","ensureMarks","splittableMarks","filteredMarks","splitBlock$1","splitBlock","_ref48","_ref48$keepMarks","keepMarks","_ref49","newAttributes","extensionManager","atEnd","deflt","indexAfter","types","can","_first","$first","canReplaceWith","splitListItem$1","splitListItem","_ref50","_state$selection3","sameParent","grandParent","wrap","depthBefore","d","copy","depthAfter","_newNextTypeAttributes","_nextType","contentMatch","createAndFill","append","replace","sel","n","nextType","newTypeAttributes","newNextTypeAttributes","findParentNode","predicate","findParentNodeClosestToPos","splitExtensions","extensions","baseExtensions","nodeExtensions","markExtensions","isList","group","joinListBackwards","listType","list","nodeBefore","nodeAt","join","joinListForwards","nodeAfter","toggleList$1","toggleList","listTypeOrName","itemTypeOrName","_ref51","itemType","parentList","validContent","wrapInList","isMarkActive","_state$selection4","markRanges","_ref52","matchedRange","markRange","excludedRange","excludes","toggleMark$1","toggleMark","_ref53","_options$extendEmptyM","extendEmptyMarkRange","unsetMark","toggleNode$1","toggleNode","toggleTypeOrName","_ref54","toggleType","toggleWrap$1","toggleWrap","_ref55","wrapIn","undoInputRule$1","undoInputRule","_ref56","plugins","plugin","undoable","isInputRules","getState","toUndo","transform","j","invert","docs","unsetAllMarks$1","unsetAllMarks","_ref57","removeMark","unsetMark$1","_ref58","_options$extendEmptyM2","removeStoredMark","updateAttributes$1","updateAttributes","_ref59","wrapIn$1","_ref60","wrapInList$1","_ref61","Commands","addCommands","Editable","_this2","editable","FocusEvents","handleDOMEvents","isFocused","transaction","createChainableState","applyTransaction","reconfigure","toJSON","CommandManager","rawCommands","customState","get","_this3","buildProps","_ref62","_ref63","callback","getMeta","hasCustomState","_this4","createChain","_this5","createCan","startTr","_this6","shouldDispatch","callbacks","hasStartTransaction","_ref64","_ref65","_this7","formattedCommands","_ref66","_ref67","_this8","_ref68","_ref69","Keymap","addKeyboardShortcuts","_this9","handleBackspace","_ref70","_ref71","isAtStart","textContent","handleDelete","_ref72","baseKeymap","Enter","_ref73","Backspace","Delete","pcKeymap","Home","End","macKeymap","_this10","appendTransaction","transactions","oldState","newState","some","docChanged","_oldState$selection","allFrom","allEnd","allWasSelected","isEmpty","textBetween","Tabindex","_this11","isEditable","tabindex","_getAttributes","_state$selection5","reverse","nodeItem","getNodeAttributes","getHTMLFromFragment","fragment","documentFragment","serializeFragment","container","implementation","createHTMLDocument","createElement","appendChild","innerHTML","_getText","InputRule","handler","run$1","rules","composing","matched","textBefore","rule","exec","inputRuleMatch","input","data","inputRuleMatcherHandler","_CommandManager2","inputRulesPlugin","init","prev","stored","selectionSet","handleTextInput","compositionend","setTimeout","$cursor","handleKeyDown","PasteRule","_CommandManager3","handlers","resolvedTo","matchAll","matches","pasteRuleMatch","pasteRuleMatcherHandler","getAttributesFromExtensions","_splitExtensions2","nodeAndMarkExtensions","defaultAttribute","default","rendered","renderHTML","parseHTML","addGlobalAttributes","globalAttribute","_ref74","_ref75","addAttributes","_ref76","_ref77","mergeAttributes","_len2","objects","_key2","mergedAttributes","_ref78","_ref79","getRenderedAttributes","nodeOrMark","injectExtensionAttributesToParseRule","parseRule","style","getAttrs","Number","fromString","getAttribute","cleanUpSchemaItem","_ref81","_ref82","isEmptyObject","getSchemaByResolvedExtensions","allAttributes","_splitExtensions3","topNode","extraNodeFields","fields","extendNodeSchema","inline","atom","selectable","draggable","defining","isolating","parseDOM","toDOM","HTMLAttributes","renderText","extraMarkFields","extendMarkSchema","inclusive","spanning","getSchemaTypeByName","isExtensionRulesEnabled","enabled","enabledExtension","ExtensionManager","_this12","extensionStorage","onBeforeCreate","on","onCreate","onUpdate","onSelectionUpdate","onTransaction","onFocus","onBlur","onDestroy","_this13","_this14","sort","inputRules","pasteRules","allPlugins","bindings","_ref83","_ref84","shortcut","method","keyMapPlugin","addInputRules","enableInputRules","addPasteRules","enablePasteRules","proseMirrorPlugins","flat","dragSourceElement","isPastedFromProseMirror","isDroppedFromProseMirror","_view","handleDragstart","parentElement","contains","addEventListener","destroy","removeEventListener","drop","paste","html","clipboardData","getData","isPaste","isDrop","findDiffStart","findDiffEnd","b","chainableState","pasteRulesPlugin","_this15","addNodeView","getPos","decorations","filtered","resolvedExtensions","flatten","duplicatedNames","el","indexOf","Set","_this16","addExtensions","a","priorityA","priorityB","EventEmitter","_this17","_len3","args","_key3","Editor","_EventEmitter","_super","_this18","element","injectCSS","autofocus","editorProps","enableCoreExtensions","isCapturingTransaction","setOptions","createExtensionManager","createCommandManager","createSchema","emit","createView","commandManager","css","tipTapStyleTag","querySelector","styleNode","setAttribute","getElementsByTagName","createStyleTag","setProps","updateState","handlePlugins","nameOrPluginKey","coreExtensions","values","allExtensions","dispatchTransaction","createNodeViews","nodeViews","_this19","selectionHasChanged","nameOrAttributes","attributesOrUndefined","_isActive","_ref85","_ref85$blockSeparator","_ref85$textSerializer","defaultContent","JSON","stringify","removeAllListeners","docView","Node","Mark","NodeView","component","isDragging","stopEvent","ignoreMutation","mount","_b","_c","dragHandle","closest","contentDOM","x","y","domBox","getBoundingClientRect","handleBox","offsetX","offsetY","dataTransfer","setDragImage","_this20","isDropEvent","tagName","isContentEditable","isDraggable","isSelectable","isCopyEvent","isPasteEvent","isCutEvent","isClickEvent","isDragEvent","preventDefault","once","mutation","isLeaf","isAtom","addedNodes","removedNodes","_this21","_ref86","nodeInputRule","_ref87","getAttributes","matchStart","lastIndexOf","lastChar","getMarksBetween","markInputRule","_ref88","captureGroup","fullMatch","markEnd","startSpaces","search","textStart","textEnd","excluded","textblockTypeInputRule","_ref89","$start","setBlockType","wrappingInputRule","_ref91","wrapping","joinPredicate","markPasteRule","_ref92","isNodeSelection","posToDOMRect","coordsAtPos","top","bottom","left","right","width","height"],"sourceRoot":""}